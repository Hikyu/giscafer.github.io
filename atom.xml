<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Giscafer&#39;s blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://giscafer.com/"/>
  <updated>2017-01-20T10:58:55.616Z</updated>
  <id>http://giscafer.com/</id>
  
  <author>
    <name>giscafer</name>
    <email>giscafer@outlook.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>React 与 Redux 实践 —— 城市筛选面板</title>
    <link href="http://giscafer.com/2017/01/20/react-redux-cityfilter-demo/"/>
    <id>http://giscafer.com/2017/01/20/react-redux-cityfilter-demo/</id>
    <published>2017-01-20T10:51:20.000Z</published>
    <updated>2017-01-20T10:58:55.616Z</updated>
    
    <content type="html"><![CDATA[<p>Redux 是 JavaScript <code>状态容器</code>，提供<code>可预测化</code>的状态管理。Redux的出现，可以让你构建一致化的应用，运行与不同的环境。</p>
<p>要点</p>
<ul>
<li>应用中所有的 state 都以一个对象树的形式存储在一个单一的 store 中；</li>
<li>唯一改变 store 的办法是触发 action，一个描述发生什么的对象；</li>
<li>为了描述 action 如何改变 state 树，你需要编写 reducers；  </li>
<li>为了UI组件 components 状态无关，你需要编写 containers 来负责管理数据和业务逻辑。</li>
</ul>
<p>所以，关于组件部分，明智的做法是在最外层上使用 Redux ，然后通过 <code>Props</code> 方式传值给内部子组件，使得components UI组件仅仅是<code>pure render</code>（纯展示）</p>
<a id="more"></a>
<p><strong>containers 与 components 区别对比</strong></p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:center">containers（容器组件）</th>
<th style="text-align:center">components（UI组件）</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Location</strong></td>
<td style="text-align:center">最顶层，路由处理</td>
<td style="text-align:center">中间和子组件</td>
</tr>
<tr>
<td><strong>与Redux联系</strong></td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td><strong>读取数据</strong></td>
<td style="text-align:center">从 Redux 获取 state</td>
<td style="text-align:center">从 props 获取数据</td>
</tr>
<tr>
<td><strong>修改数据</strong></td>
<td style="text-align:center">从 Redux 派发 action</td>
<td style="text-align:center">从 props 调用回调函数</td>
</tr>
</tbody>
</table>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>通过一个城市筛选面板来理解 React + Redux 的使用</p>
<p><img src="/static/img/react-redux-cityfilter-demo.gif" alt=""></p>
<p>示例demo：<a href="http://giscafer.com/react-demo-list/#/citypanel">http://giscafer.com/react-demo-list/#/citypanel</a></p>
<p>源码：<a href="https://github.com/giscafer/react-demo-list" target="_blank" rel="external">https://github.com/giscafer/react-demo-list</a></p>
<p><strong>编写 React 应用的时候，会有一个大致的开发步骤</strong>：</p>
<ul>
<li>构建应用状态树 state 结构</li>
<li>编写 action （描述已发生事件的普通对象，所有修改 state 的操作都必须通过触发action）</li>
<li>编写 reducers （描述 action 如何改变 state tree）</li>
<li>编写 UI组件 components （纯组件，无状态，所有参数通过Props传，可复用性）</li>
<li>编写 容器组件 containers （用来负责管理数据和业务逻辑，react-redux 链接components）</li>
<li>通过 createStore 创建store，通过 Provider 包装根组件</li>
</ul>
<h2 id="Action-创建常量和函数"><a href="#Action-创建常量和函数" class="headerlink" title="Action 创建常量和函数"></a>Action 创建常量和函数</h2><p>定好<code>state tree</code>后，编写actions</p>
<p><code>actions.jsx</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * citypanel actions</div><div class="line"> */</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_VISIBILITY_FILTER = <span class="string">'SET_VISIBILITY_FILTER'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">setVisibilityFilter</span>(<span class="params">filter</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>: SET_VISIBILITY_FILTER, filter &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Reducers"><a href="#Reducers" class="headerlink" title="Reducers"></a>Reducers</h2><p>当应用很大时，可以将它拆成多个小的 reducers，分别独立地操作 state tree 的不同部分，因为 reducer 只是函数，你可以控制它们被调用的顺序，传入附加数据，甚至编写可复用的 reducer 来处理一些通用任务，如分页器</p>
<p><code>reducer 和 action 是好基友</code></p>
<p><code>./reducers/cityList.jsx</code> </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; SET_VISIBILITY_FILTER &#125; <span class="keyword">from</span> <span class="string">'../../actions/citypanel/actions'</span>;</div><div class="line"><span class="keyword">import</span> &#123; cityData &#125; <span class="keyword">from</span> <span class="string">'./cityData.js'</span>;</div><div class="line"><span class="keyword">const</span> initialState = cityData.filter(<span class="function"><span class="params">item</span> =&gt;</span> item[<span class="string">'citynum'</span>])</div><div class="line"><span class="built_in">console</span>.log(initialState)</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">cityList</span>(<span class="params">state = initialState, action</span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">switch</span> (action.type) &#123;</div><div class="line">        <span class="keyword">case</span> SET_VISIBILITY_FILTER:</div><div class="line">            <span class="keyword">return</span> cityFilter(action.filter)</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> state</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cityFilter</span>(<span class="params">filter</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> cityData.map(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">if</span> (filter === <span class="string">'特大'</span> || !filter) &#123;</div><div class="line">            <span class="keyword">if</span> (item[<span class="string">'citynum'</span>]) &#123;</div><div class="line">                <span class="keyword">return</span> item;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item[<span class="string">'pinyin'</span>][<span class="number">0</span>].toLocaleUpperCase() === filter &amp;&amp; !item[<span class="string">'citynum'</span>]) &#123;</div><div class="line">            <span class="keyword">return</span> item;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">console</span>.log(filter)</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>./reducers/index.jsx</code> 组合所有reducers （多个的时候用）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> cityList <span class="keyword">from</span> <span class="string">'./cityList'</span></div><div class="line"></div><div class="line"><span class="comment">//使用redux的combineReducers方法将所有reducer打包起来</span></div><div class="line"><span class="keyword">const</span> rootReducer = combineReducers(&#123;</div><div class="line">    cityList</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> rootReducer</div></pre></td></tr></table></figure>
<h2 id="UI组件components"><a href="#UI组件components" class="headerlink" title="UI组件components"></a>UI组件components</h2><p>宗旨就是<code>pure function</code></p>
<p><code>./components/cityList.jsx</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;cityList = []&#125;) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">        &lt;ul className='city-list'&gt;</div><div class="line">            &#123;</div><div class="line">                cityList.map((city,index) =&gt; &#123;</div><div class="line">                    if(city)&#123;</div><div class="line">                        return &lt;li className='left textCenter' key=&#123;index&#125; data-name=&#123;city.name&#125;&gt;&#123;city.name&#125;&lt;/li&gt;</div><div class="line">                    &#125;</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">        &lt;/ul&gt;</div><div class="line">    );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>./components/letterFilter.jsx</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;onFilterChange&#125;) =&gt; &#123;</div><div class="line">    <span class="comment">// let letterArr = new Array(26);</span></div><div class="line">    <span class="comment">// for (var i = 0; i &lt; 26; i++) &#123;</span></div><div class="line">    <span class="comment">//     letterArr[i]=String.fromCharCode((65 + i));</span></div><div class="line">    <span class="comment">// &#125;</span></div><div class="line">    <span class="comment">// console.log(letterArr)</span></div><div class="line">    <span class="keyword">let</span> letterArr=[<span class="string">'特大'</span>,<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>];</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">        &lt;ul className='city-index'&gt;</div><div class="line">            &#123;</div><div class="line">                letterArr.map((letter,i) =&gt; &#123;</div><div class="line">                    return &lt;li className='left textCenter on_mouseover' key=&#123;i&#125; onClick=&#123;()=&gt;&#123; onFilterChange(letter) &#125;&#125;&gt;&#123;letter&#125;&lt;/li&gt;</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">        &lt;/ul&gt;</div><div class="line">    );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>外层组件组合letterFilter与cityList子组件，<code>./components/index.jsx</code></p>
<p>//此处的函数参数cityList与setVisibilityFilter是由容器组件传输</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> LetterFilter <span class="keyword">from</span> <span class="string">'./letterFilter'</span>;</div><div class="line"><span class="keyword">import</span> CityList <span class="keyword">from</span> <span class="string">'./cityList'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'../../styles/citypanel/index.less'</span>;</div><div class="line"><span class="keyword">import</span> Nav <span class="keyword">from</span> <span class="string">'../nav/Nav'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;cityList = [], setVisibilityFilter&#125;) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">        &lt;div className='city-panel'&gt;</div><div class="line">             &lt;Nav /&gt;</div><div class="line">            &lt;CityList cityList=&#123;cityList&#125; /&gt;</div><div class="line">            &lt;LetterFilter onFilterChange=&#123;setVisibilityFilter&#125; /&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="容器组件containers"><a href="#容器组件containers" class="headerlink" title="容器组件containers"></a>容器组件containers</h2><p>主要是通过<code>react-redux</code>中间件提供的<code>connect</code>方法来链接<code>containers</code>与<code>components</code>，而<code>connect</code> 方法提供了两个方法 <code>mapStateToProps</code> 与 <code>mapDispatchToProps</code>，它们定义了 UI 组件的业务逻辑。前者负责输入逻辑。<br><code>mapStateToProps</code>将 state 映射到 UI 组件的参数（Props），<code>mapDispatchToProps</code>负责输出逻辑，即将用户对 UI 组件的操作映射成 Action，也可以通过<code>bindActionCreators</code>方法将<code>action</code>的所有方法绑定到props上。</p>
<p><code>./containers/App.jsx</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> cityPanelIndex <span class="keyword">from</span> <span class="string">'../../components/citypanel/index'</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> ctiyActions <span class="keyword">from</span> <span class="string">'../../actions/citypanel/actions'</span></div><div class="line"></div><div class="line"><span class="comment">//将state.cityList绑定到props的cityList</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">cityList</span>:state.cityList</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//将action的所有方法绑定到props上</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> bindActionCreators(ctiyActions,dispatch);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(cityPanelIndex)</div></pre></td></tr></table></figure>
<h2 id="注册store"><a href="#注册store" class="headerlink" title="注册store"></a>注册store</h2><p>将 state 和 action 交给 redux 来管理</p>
<p><code>./stores/createStore.jsx</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span></div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'../reducers/citypanel'</span></div><div class="line"><span class="comment">//applyMiddleware来自redux可以包装 store 的 dispatch</span></div><div class="line"><span class="comment">//thunk作用是使action创建函数可以返回一个function代替一个action对象</span></div><div class="line"><span class="keyword">const</span> createStoreWithMiddleware = applyMiddleware(</div><div class="line">  thunk</div><div class="line">)(createStore)</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">configureStore</span>(<span class="params">initialState</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> store = createStoreWithMiddleware(reducer, initialState)</div><div class="line">  <span class="comment">//热替换选项</span></div><div class="line">  <span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</div><div class="line">    <span class="comment">// Enable Webpack hot module replacement for reducers</span></div><div class="line">    <span class="built_in">module</span>.hot.accept(<span class="string">'../reducers/citypanel'</span>, () =&gt; &#123;</div><div class="line">      <span class="keyword">const</span> nextReducer = <span class="built_in">require</span>(<span class="string">'../reducers/citypanel'</span>)</div><div class="line">      store.replaceReducer(nextReducer)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> store</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="App主文件入口"><a href="#App主文件入口" class="headerlink" title="App主文件入口"></a>App主文件入口</h2><p>最终Provider包装主组件（containers）</p>
<p><code>Main.jsx</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * citypanel主入口</div><div class="line"> */</div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'../../containers/citypanel/App'</span></div><div class="line"><span class="keyword">import</span> configureStore <span class="keyword">from</span> <span class="string">'../../stores/configureStore'</span></div><div class="line"><span class="keyword">const</span> store = configureStore()</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">        &lt;Provider store=&#123;store&#125;&gt;</div><div class="line">            &lt;App /&gt;</div><div class="line">        &lt;/Provider&gt;</div><div class="line">    )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>一个react + redux 应用完成了</p>
<p>演示：<a href="http://giscafer.com/react-demo-list/#/citypanel">http://giscafer.com/react-demo-list/#/citypanel</a></p>
<p>源码：<a href="https://github.com/giscafer/react-demo-list" target="_blank" rel="external">https://github.com/giscafer/react-demo-list</a></p>
<p>（完）</p>
<hr>
<p><em>参考链接</em></p>
<ul>
<li><a href="http://www.jianshu.com/p/a83a99f68b5d" target="_blank" rel="external">http://www.jianshu.com/p/a83a99f68b5d</a></li>
<li><a href="https://lewis617.github.io/2016/01/19/r2-counter/" target="_blank" rel="external">https://lewis617.github.io/2016/01/19/r2-counter/</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_three_react-redux.html</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Redux 是 JavaScript &lt;code&gt;状态容器&lt;/code&gt;，提供&lt;code&gt;可预测化&lt;/code&gt;的状态管理。Redux的出现，可以让你构建一致化的应用，运行与不同的环境。&lt;/p&gt;
&lt;p&gt;要点&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;应用中所有的 state 都以一个对象树的形式存储在一个单一的 store 中；&lt;/li&gt;
&lt;li&gt;唯一改变 store 的办法是触发 action，一个描述发生什么的对象；&lt;/li&gt;
&lt;li&gt;为了描述 action 如何改变 state 树，你需要编写 reducers；  &lt;/li&gt;
&lt;li&gt;为了UI组件 components 状态无关，你需要编写 containers 来负责管理数据和业务逻辑。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以，关于组件部分，明智的做法是在最外层上使用 Redux ，然后通过 &lt;code&gt;Props&lt;/code&gt; 方式传值给内部子组件，使得components UI组件仅仅是&lt;code&gt;pure render&lt;/code&gt;（纯展示）&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="React" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/React/"/>
    
    
      <category term="React" scheme="http://giscafer.com/tags/React/"/>
    
      <category term="redux" scheme="http://giscafer.com/tags/redux/"/>
    
      <category term="react-redux" scheme="http://giscafer.com/tags/react-redux/"/>
    
  </entry>
  
  <entry>
    <title>1.Two Sum</title>
    <link href="http://giscafer.com/2017/01/13/leetcode-two-sum/"/>
    <id>http://giscafer.com/2017/01/13/leetcode-two-sum/</id>
    <published>2017-01-13T12:24:00.000Z</published>
    <updated>2017-01-13T13:04:29.249Z</updated>
    
    <content type="html"><![CDATA[<p><em>原题地址：<a href="https://leetcode.com/problems/two-sum/" target="_blank" rel="external">https://leetcode.com/problems/two-sum/</a></em></p>
<blockquote>
<p>Given an array of integers, return indices of the two numbers such that they add up to a specific target.</p>
<p>You may assume that each input would have exactly one solution.</p>
<p>Example:<br>Given nums = [2, 7, 11, 15], target = 9,</p>
<p>Because nums[0] + nums[1] = 2 + 7 = 9,<br>return [0, 1].</p>
</blockquote>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>正常两次循环，循环次数可能多，只要数组不是很大，效率还是很高的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * @param &#123;number[]&#125; nums</div><div class="line"> * @param &#123;number&#125; target</div><div class="line"> * @return &#123;number[]&#125;</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">var</span> twoSum = <span class="function"><span class="keyword">function</span>(<span class="params">nums, target</span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.time(<span class="string">'twoSum'</span>)</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;nums.length;i++)&#123;</div><div class="line"></div><div class="line">    	<span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; nums.length&amp;&amp; i!=j; j++) &#123;</div><div class="line">    		<span class="keyword">if</span>(nums[j]+nums[i]===target)&#123;</div><div class="line">    			<span class="built_in">console</span>.timeEnd(<span class="string">'twoSum'</span>)</div><div class="line">    			<span class="keyword">var</span> result=[i,j].sort();</div><div class="line">    			<span class="keyword">return</span> result</div><div class="line">    		&#125;</div><div class="line">    	&#125;;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>边循环边使用对象存储</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> twoSum2 = <span class="function"><span class="keyword">function</span>(<span class="params">nums, target</span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.time(<span class="string">'twoSum2'</span>)</div><div class="line">	<span class="keyword">var</span> obj=&#123;&#125;;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;nums.length;i++)&#123;</div><div class="line">    	<span class="keyword">if</span>(obj[nums[i+<span class="string">''</span>]]!==<span class="literal">null</span> &amp;&amp; obj[nums[i+<span class="string">''</span>]]!==<span class="literal">undefined</span>)&#123;</div><div class="line">    		<span class="keyword">var</span> result=[obj[nums[i]],i];</div><div class="line">    		 <span class="built_in">console</span>.timeEnd(<span class="string">'twoSum2'</span>)</div><div class="line">    		<span class="keyword">return</span> result;</div><div class="line">    	&#125;</div><div class="line">    	obj[target-nums[i]]=i;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> result2=[];</div><div class="line">    <span class="keyword">return</span> result2;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>测试结果，建议使用更大的数组测试，才会看到<code>twoSum2</code>方法效率高</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var nums = [<span class="number">2</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>], target = <span class="number">9</span>;</div><div class="line"><span class="comment">// var nums = [11, 15, 9,1,1,3,1,11, 15, 9,1,1,3,1,1,1,1,1,2,7,3], target = 9;</span></div><div class="line">twoSum(nums,target);</div><div class="line">twoSum2(nums,target);</div></pre></td></tr></table></figure>
<p>经测试，在小数组时，<code>twoSum方法</code>比<code>twoSum2</code>快很多，当数组变大时，<code>twoSum2</code>算法更快</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;原题地址：&lt;a href=&quot;https://leetcode.com/problems/two-sum/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://leetcode.com/problems/two-sum/&lt;/a&gt;&lt;/em&gt;&lt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="LeetCode" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/LeetCode/"/>
    
    
      <category term="leetcode" scheme="http://giscafer.com/tags/leetcode/"/>
    
      <category term="算法" scheme="http://giscafer.com/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>如何组件化开发WebGIS系统</title>
    <link href="http://giscafer.com/2017/01/10/modularization-webgis/"/>
    <id>http://giscafer.com/2017/01/10/modularization-webgis/</id>
    <published>2017-01-10T15:09:31.000Z</published>
    <updated>2017-01-12T14:04:06.378Z</updated>
    
    <content type="html"><![CDATA[<h3 id="啰嗦两句"><a href="#啰嗦两句" class="headerlink" title="啰嗦两句"></a>啰嗦两句</h3><p>前面聊过<a href="https://zhuanlan.zhihu.com/p/24780835?refer=viseye" target="_blank" rel="external">《探讨如何使用流行的前端技术开发WebGIS系统》</a>，本篇基于此继续介绍。</p>
<p><em>不用再讨论兼容IE6，7了，2017年，没人再用了。。。。哈哈哈</em></p>
<p>本人目前正业余开发一套框架，后端Java+前端Angular+个人封装的UI+个人封装的地图组件，东西很多，一个人搞，这是一个漫长的过程。这也是为什么最近再Github上如此活跃的原因，也因为最近一段时间没加过班。。。除了玩游戏就只能写代码了。。</p>
<p>=&gt;<a href="https://github.com/giscafer" target="_blank" rel="external">giscafer (Nickbing Lao)</a></p>
<h3 id="一、后端完善的Restful接口设计有利前端组件封装"><a href="#一、后端完善的Restful接口设计有利前端组件封装" class="headerlink" title="一、后端完善的Restful接口设计有利前端组件封装"></a>一、后端完善的Restful接口设计有利前端组件封装</h3><p>比如知乎的文章链接</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https:<span class="regexp">//</span>zhuanlan.zhihu.com<span class="regexp">/p/</span><span class="number">24780835</span></div></pre></td></tr></table></figure>
<p>可以看作一个GET请求，接口p，参数为24780835。这个接口可以查所有文章。</p>
<p>做WebGIS系统，后端框架，接口设计好用，能提升前端开发的效率，并且可以针对接口封装一些增删改查的组件，在angular里边，你可以封装成指令或者是controller，然后其他业务controller集成此类，就继承了该类的所有方法了。比如应用里边我封装了增删改查的操作，只要是单表的CRUD（增查改删），完全不需要写多余的CRUD代码，只需要修改一下HTML和传参。如下代码可以改为一个通用的父类Controller。</p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Test controller</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">import</span> popFormCtrl <span class="keyword">from</span> <span class="string">'./popForm.ctrl.js'</span>;</div><div class="line"><span class="keyword">import</span> popFormTemp <span class="keyword">from</span> <span class="string">'./popForm.html'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCtrl</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// dataServiceSrv, uiNotification为依赖注入服务，其中uiNotification为laoui封装ui控件</span></div><div class="line">    <span class="keyword">constructor</span>($scope, dataServiceSrv, uiNotification, $uiModal) &#123;</div><div class="line">        <span class="string">"ngInject"</span>;<span class="comment">//ES6写angularjs指定写法；作用是依赖注入上边的$scope, dataServiceSrv, uiNotification模块</span></div><div class="line">        <span class="keyword">this</span>._$scope = $scope;</div><div class="line">        <span class="keyword">this</span>._$uiModal = $uiModal;</div><div class="line">        <span class="keyword">this</span>._dataServiceSrv = dataServiceSrv;</div><div class="line">        <span class="keyword">this</span>._uiNotification = uiNotification;</div><div class="line">        <span class="keyword">this</span>.tableName = <span class="string">'student'</span>;</div><div class="line">        <span class="keyword">this</span>.title = <span class="string">"测试页"</span>;</div><div class="line">        <span class="comment">//查询标志位</span></div><div class="line">        <span class="keyword">this</span>.loading = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">this</span>.deleting = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">this</span>.isAllChecked = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">this</span>.table = [];</div><div class="line">        <span class="keyword">this</span>.query();</div><div class="line">        <span class="comment">//过滤器自定义方法 | filter:方法名称</span></div><div class="line">        <span class="keyword">this</span>.filterData=<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</div><div class="line">           <span class="keyword">return</span> item._deleted!=<span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//测试查询</span></div><div class="line">    query() &#123;</div><div class="line">        <span class="keyword">let</span> params = &#123;</div><div class="line">            <span class="string">"tableName"</span>: <span class="keyword">this</span>.tableName</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.loading = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">this</span>._dataServiceSrv.query(params).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</div><div class="line">            <span class="keyword">if</span> (data[<span class="string">'result'</span>].length) &#123;</div><div class="line">                <span class="keyword">this</span>.table = data[<span class="string">'result'</span>];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">this</span>._uiNotification.info(<span class="string">'无数据'</span>)</div><div class="line">            &#125;</div><div class="line">        &#125;).finally(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="keyword">this</span>.loading = <span class="literal">false</span>;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//新增</span></div><div class="line">    add() &#123;</div><div class="line">        <span class="keyword">let</span> params = &#123;</div><div class="line">            <span class="attr">title</span>: <span class="string">'新增'</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.openPopForm(params);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//修改</span></div><div class="line">    update() &#123;</div><div class="line">        <span class="keyword">let</span> selectedRows = <span class="keyword">this</span>.getSelectedRows();</div><div class="line">        <span class="keyword">if</span> (selectedRows.length !== <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">let</span> options = &#123;</div><div class="line">                <span class="attr">message</span>: <span class="string">'请选中一条记录！'</span>, <span class="attr">positionX</span>: <span class="string">'center'</span>, <span class="attr">positionY</span>: <span class="string">'top'</span>, <span class="attr">delay</span>: <span class="number">2000</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>._uiNotification.warning(options);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">let</span> params = &#123;</div><div class="line">            <span class="attr">title</span>: <span class="string">'修改'</span>,</div><div class="line">            <span class="attr">data</span>: selectedRows[<span class="number">0</span>]</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.openPopForm(params);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">delete</span>() &#123;</div><div class="line">        <span class="keyword">let</span> selectedRows = <span class="keyword">this</span>.getSelectedRows();</div><div class="line">        <span class="built_in">console</span>.log(selectedRows)</div><div class="line">        <span class="keyword">if</span> (!selectedRows.length) &#123;</div><div class="line">            <span class="keyword">let</span> options = &#123;</div><div class="line">                <span class="attr">message</span>: <span class="string">'请选中需要删除的记录！'</span>, <span class="attr">positionX</span>: <span class="string">'center'</span>, <span class="attr">positionY</span>: <span class="string">'top'</span>, <span class="attr">delay</span>: <span class="number">2000</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>._uiNotification.warning(options);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">let</span> idArr = _.map(selectedRows, <span class="string">'id'</span>);</div><div class="line">        <span class="keyword">let</span> idValues = idArr.join(<span class="string">","</span>);</div><div class="line">        <span class="keyword">let</span> params = &#123;</div><div class="line">            <span class="attr">idValues</span>: idValues,</div><div class="line">            <span class="attr">tableName</span>: <span class="keyword">this</span>.tableName</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.deleting = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">this</span>._dataServiceSrv.deleteByKey(params).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</div><div class="line">            <span class="keyword">if</span> (res[<span class="string">'result'</span>]) &#123;</div><div class="line">                <span class="keyword">this</span>._uiNotification.success(<span class="string">'删除成功!'</span>);</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> selectedRows)&#123;</div><div class="line">                    item._deleted=<span class="literal">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                 <span class="keyword">this</span>._uiNotification.error(<span class="string">'删除失败!'</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;).finally(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="keyword">this</span>.deleting = <span class="literal">false</span>;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//通用弹窗</span></div><div class="line">    openPopForm(params = &#123;&#125;) &#123;</div><div class="line">        <span class="keyword">let</span> modalInstance = <span class="keyword">this</span>._$uiModal.open(&#123;</div><div class="line">            <span class="attr">templateUrl</span>: popFormTemp,</div><div class="line">            <span class="attr">controller</span>: popFormCtrl,</div><div class="line">            <span class="attr">controllerAs</span>: <span class="string">'popForm'</span>,</div><div class="line">            <span class="attr">size</span>: <span class="string">'lg'</span>,</div><div class="line">            <span class="attr">backdrop</span>: <span class="string">'static'</span>,</div><div class="line">            <span class="attr">resolve</span>: &#123;</div><div class="line">                <span class="attr">items</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">                    <span class="keyword">return</span> params;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    selectedAll() &#123;</div><div class="line">        <span class="keyword">this</span>.table.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</div><div class="line">            item.checked = <span class="keyword">this</span>.isAllChecked;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    check() &#123;</div><div class="line">        <span class="keyword">this</span>.isAllChecked = !_.some(<span class="keyword">this</span>.table, (item) =&gt; &#123;</div><div class="line">            <span class="keyword">return</span> !item.checked;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    selectByClick($event, item) &#123;</div><div class="line">        <span class="keyword">if</span> ($event.target.type !== <span class="string">'checkbox'</span>) &#123;</div><div class="line">            item.checked = !item.checked;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    getSelectedRows() &#123;</div><div class="line">        <span class="keyword">return</span> _.filter(<span class="keyword">this</span>.table, (item) =&gt; &#123;</div><div class="line">            <span class="keyword">return</span> item.checked === <span class="literal">true</span>;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/static/img/modularization-webgis1.png" alt=""></p>
<p><img src="/static/img/modularization-webgis2.png" alt=""></p>
<p>可以封装的内容出CRUD外，还包括一些限制控制，通知提示，表单验证等。</p>
<p>因为是angular框架，双向数据绑定，比传统的jqueryUI，easyUI这堆好用的多，这么一来简单的表单页面开发起来就不费任何力气，简单复制模板修改一下就OK。</p>
<h3 id="二、地图工具组件化"><a href="#二、地图工具组件化" class="headerlink" title="二、地图工具组件化"></a>二、地图工具组件化</h3><p>同理，地图工具组件化是必须的。（防转载标记，个人微信公众号：giscafer）</p>
<p>每个WebGIS系统都有这些一模一样的工具：<strong>全屏、放大、缩小、距离测量、面积测量、i键查询、坐标定位</strong> 等等，这些工具可以封装为无平台相关，也就是兼容所有地图js库，不管是ArcGIS API For JavaScript，还是OpenLayers 等，就比如我封装了一个叫 DMap 的地图库，里边大致结构如图：</p>
<p><img src="/static/img/modularization-webgis-dmap.png" alt="DMap库结构图"></p>
<p>在开发系统时，我选择了<code>Mapbox</code>作为地图js库，我在<code>dmap_config.js</code>文件中配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">DMAP_JS_TYPE:<span class="string">"MAPBOX"</span></div></pre></td></tr></table></figure>
<p>这时候我可以自动构建打包一套Mapbox的js库（当然和原生库不一样，我封装了一些组件类，下边介绍）。同理我配置<code>DMAP_JS_TYPE:&quot;OL3&quot;</code>，就表示构建OL3组件库。</p>
<p>构建方式用<code>nodejs</code> + <code>webpack</code>等工具开发，类似 <a href="http://echarts.baidu.com/builder.html" target="_blank" rel="external">Echarts的构建方式</a> </p>
<p>然后我把组件库引入我开发的webgis系统。通过无平台相关（这表示和地图 js库无关）接口 Map 创建地图</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="string">"map"</span>, &#123;</div><div class="line">      <span class="comment">//配置</span></div><div class="line">       projection: <span class="string">"EPSG:900913"</span>,</div><div class="line">       <span class="attr">center</span>: [<span class="number">118.665397</span>, <span class="number">47.6569168</span>],</div><div class="line">       <span class="attr">zoom</span>: <span class="number">5</span></div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<p>另外，地图类型加载也可以封装成，通过配置地图类型比如，天地图OGC_WMTS，还是高德地图AMAP，demo《<a href="https://zhuanlan.zhihu.com/p/24780835?refer=viseye" target="_blank" rel="external">《探讨如何使用流行的前端技术开发WebGIS系统》</a> 就是配置的高德地图。这些地图加载同样封装成无平台相关。</p>
<p>以下是组件封装后使用demo截图：</p>
<p><img src="/static/img/modularization-webgis3.png" alt=""></p>
<p><img src="/static/img/modularization-webgis4.png" alt=""></p>
<p>最终，封装好后，以后做项目不用任何代码就可以构建一个webgis系统雏形出来，这个雏形系统带有基本的表单增删改查组件、全屏、放大、缩小、距离测量、面积测量、i键查询、坐标定位 等直接可用的地图组件。</p>
<h3 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h3><p>在WebGIS系统开发里边，有较多的表单业务，封装成组件开发是最方便的，也可以找网上的一些开源库做修改，定制成自己通用的才是最好用的。</p>
<p>已不从事gis行业，业余有外包机会或者兼职机会希望可以接一下，所以自己定制一个前端后端一整套框架，一方面学习，一方面积累技术。工作量很大，有时间一步一步慢慢来，并且业余还得学前端技术，React Native是下一个学习目标。</p>
<p>此外，框架设计的时候，考虑到不加载dmap地图库的时候，就是一个完全纯净的业务系统，可以用来做其他网站，比如企业站点、博客等。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;啰嗦两句&quot;&gt;&lt;a href=&quot;#啰嗦两句&quot; class=&quot;headerlink&quot; title=&quot;啰嗦两句&quot;&gt;&lt;/a&gt;啰嗦两句&lt;/h3&gt;&lt;p&gt;前面聊过&lt;a href=&quot;https://zhuanlan.zhihu.com/p/24780835?refer=viseye&quot;&gt;《探讨如何使用流行的前端技术开发WebGIS系统》&lt;/a&gt;，本篇基于此继续介绍。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;不用再讨论兼容IE6，7了，2017年，没人再用了。。。。哈哈哈&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;本人目前正业余开发一套框架，后端Java+前端Angular+个人封装的UI+个人封装的地图组件，东西很多，一个人搞，这是一个漫长的过程。这也是为什么最近再Github上如此活跃的原因，也因为最近一段时间没加过班。。。除了玩游戏就只能写代码了。。&lt;/p&gt;
&lt;p&gt;=&amp;gt;&lt;a href=&quot;https://github.com/giscafer&quot;&gt;giscafer (Nickbing Lao)&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;一、后端完善的Restful接口设计有利前端组件封装&quot;&gt;&lt;a href=&quot;#一、后端完善的Restful接口设计有利前端组件封装&quot; class=&quot;headerlink&quot; title=&quot;一、后端完善的Restful接口设计有利前端组件封装&quot;&gt;&lt;/a&gt;一、后端完善的Restful接口设计有利前端组件封装&lt;/h3&gt;&lt;p&gt;比如知乎的文章链接&lt;/p&gt;
&lt;figure class=&quot;highlight awk&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;https:&lt;span class=&quot;regexp&quot;&gt;//&lt;/span&gt;zhuanlan.zhihu.com&lt;span class=&quot;regexp&quot;&gt;/p/&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;24780835&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看作一个GET请求，接口p，参数为24780835。这个接口可以查所有文章。&lt;/p&gt;
&lt;p&gt;做WebGIS系统，后端框架，接口设计好用，能提升前端开发的效率，并且可以针对接口封装一些增删改查的组件，在angular里边，你可以封装成指令或者是controller，然后其他业务controller集成此类，就继承了该类的所有方法了。比如应用里边我封装了增删改查的操作，只要是单表的CRUD（增查改删），完全不需要写多余的CRUD代码，只需要修改一下HTML和传参。如下代码可以改为一个通用的父类Controller。&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="WebGIS" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/WebGIS/"/>
    
    
      <category term="WebGIS" scheme="http://giscafer.com/tags/WebGIS/"/>
    
      <category term="gis" scheme="http://giscafer.com/tags/gis/"/>
    
  </entry>
  
  <entry>
    <title>2016年末总结</title>
    <link href="http://giscafer.com/2016/12/23/2016-year-end-summary/"/>
    <id>http://giscafer.com/2016/12/23/2016-year-end-summary/</id>
    <published>2016-12-23T12:55:29.000Z</published>
    <updated>2016-12-24T16:46:23.697Z</updated>
    
    <content type="html"><![CDATA[<p>年底了，毕业两年半，也就是工作2年半了，times flying！！！</p>
<p>2016年，变化比较大的有三方面：工作地点由北京换到广州、脱离单身dog、gis行业转互联网（勉强算，都是做编程开发）。</p>
<a id="more"></a>
<h3 id="北京——广州"><a href="#北京——广州" class="headerlink" title="北京——广州"></a>北京——广州</h3><p><strong>北京</strong> 毕业北漂[求技]之旅，刚好两年，不长不短，体验到了北京大都市的生活节奏和人情风俗。总体来说都挺好的，除了雾霾天气比较严重外，其他给我的印象都不错；比如北京的街道很干净，公民总体素质高，社会基础设施，安全保障等，但最重要的还属于北京资源丰富。[资源]包括教育、医疗、科技等方方面面，it行业创业公司和氛围都很好，大型it公司也很多，竞争激烈，然而我并不能收益很多，两年时间是不够的。</p>
<p>我简单谈一下北漂的感受。实话说，程序猿北漂是相对轻松一点的吧，起薪高，尽管北京消费租房是昂贵的，还是能支付的起。比如租房2k月租左右的预付，能找到不错的，一个月2k的吃喝也足了（往低的说，你合租可以找1k~1.5k的房子，吃的话一天50也够了，一个月也就1.5k）。所以说，程序猿北漂是可以的，具体看个人了，可能还会买买衣服，电子产品这些，最后能不能省钱是一回事，反正我没剩钱。刚毕业，技术放在第一，养活自己就可以了。想在北京定居不容易，户口和房价是个问题。</p>
<p><strong>广州</strong>  刚来广州的时候，感受和北京差别比较大有地铁安检，只能说好简单的安检，也没西安安检严格；街道不够干净，垃圾比较多（非树叶）；租房，不好租，广州整租的很多，很少单独租主卧这种的，整租的话也贵，3k~4k 一个月（当然我指的是稍微交通便利的地带）。来广州我租了一间单间，1.7k的月租（北京我租的是次卧1.4k），附近吃喝和北京相比没差别，所以消费是和北京几乎等同的了，但是广州薪资和北京相比是有 20%~50% 浮动的差距的，房价慢慢涨到2W+每平米的水平。另外一个是交通不方便的问题，广州人多，交通运输量不够，还是地铁线设计有问题。早班时，地铁根本不能坐（广州3号线），挤地铁能活着不容易啊。</p>
<p>广州也有好的地方，好处就不说了。作为南方人，广州是最好的选择吧，起码离家近，能常回家看看！</p>
<h3 id="GIS——互联网前端"><a href="#GIS——互联网前端" class="headerlink" title="GIS——互联网前端"></a>GIS——互联网前端</h3><p>GIS专业毕业，我能选择的只有两个方向：一、数据处理工程师；二、软件开发工程师；因为我也只会这两个了。选开发那是肯定的，因为我一向不喜欢用软件搞数据，天天重复做着差不多的事情。开发也是天天写代码，但是写的代码不一样，思考的东西也不一样，发展方向也广阔，看的是技术能力和学习能力。</p>
<p>离开GIS行业是有原因的，在第一家公司里做GIS项目有10多个了，感受比较深的是，做这类政务系统，要求很低，安全性和稳定性以及易用性等。从前端来讲，优化是谈不上的，只要把功能做出来，没bug就OK。我觉得这不是前端所追求的，作为前端开发方向发展的我，选择离开是正确的。</p>
<h3 id="走着并追赶在前端的潮流之上"><a href="#走着并追赶在前端的潮流之上" class="headerlink" title="走着并追赶在前端的潮流之上"></a>走着并追赶在前端的潮流之上</h3><p>这几年，前端很火，变化的也多。前些天，一些大牛又在微博撕X，辩论XX技术好不好，有没有意义。作为前端小菜，我觉得新推出的技术、框架是要学习了解一下的，不管用不用上，学习了解一下没啥大不了，只有学习才能正确体验到框架是否真正好用，适用什么场景。实际上，有几年工作经验的程序猿，学一个框架，也就是一个周末而已就差不多了解其使用、适用场景了，就如入门一门新编程语言，可能也只需要一两周的时间。所以在前端混的，有选择的学习一下一些新技术是必要的。在前端潮流中享受与受伤吧~~o(╯□╰)o，听说2017年，新版webkit内核浏览器将支持模块化js，也就是commonjs，AMD这些直接支持了，再过几年淘汰老版本浏览器后就不需要编译了。。一切都在变化之中，或者已经在变化的路上！</p>
<p>这一年，做了很多小应用和demo，目前在用Angular封装一套前端ui框架，后端用JFinal封装一套接口服务，目的是学习和方便以后快速定制开发系统使用。想拥有自己的框架或能拿出手的东西，有时间和机会也接一下小项目、网站做等。</p>
<p>如果你的项目有意思想找人一起开发维护，或者纯技术交流学习，我在这Github：<a href="https://github.com/giscafer" target="_blank" rel="external">giscafer</a></p>
<p>以下是敲击记录（<em>我觉得github日历上满满的绿的用户，多数是前端开发方向</em>）</p>
<p><img src="/static/img/2016-github.png" alt="2016年Github提交记录"></p>
<p>2017年继续有计划地学习，计划开发一个上线运营的App，技术用<code>React Native</code>还是<code>Angualr Ionic2</code>待定，内容定位暂定为GIS学习方向。有兴趣的同学可以一起玩~</p>
<p>最后引入 [转自微博@tombkeeper]的话来总结：</p>
<p><strong>从事任何技术研究，不知道该干什么的时候，就问自己四个问题</strong></p>
<pre><code>- 这个方向上最新进展是什么？ 都知道吗？
- 这个方向上最著名的专家有哪些？他们的研究都看过吗？
- 这个方向上最著名的技术社区有哪些？精华帖都看过一遍吗？
- 这个方向上最重要的文章、工具有哪些？文章都看过吗？工具都分析过吗？
- 你有对象了吗？（针对程序猿）
</code></pre><h3 id="脱离单身dog"><a href="#脱离单身dog" class="headerlink" title="脱离单身dog"></a>脱离单身dog</h3><p>现在终于可以专心啪啪啪~敲着键盘，宅着写代码了。。。女票说想学测试，正在指导学习的路上，学不成也无所谓，能更好的了解计算机和互联网，不会那么电脑文盲，但也可能不小心入坑了呢。。。</p>
<h3 id="生活上"><a href="#生活上" class="headerlink" title="生活上"></a>生活上</h3><p>2016年没去几个城市，只有北京、陕西、广州、福州（出差一个月）。生活质量期待以后的提升，计划一些旅游什么的，为了目标努力吧！！！</p>
<h3 id="读书"><a href="#读书" class="headerlink" title="读书"></a>读书</h3><p>看书时间是不少的，非技术书籍寥寥无几，这方面是需要改善的地方，2017年开始计划着时间多读一下文学类的书籍陶冶身心。</p>
<h3 id="科技时代"><a href="#科技时代" class="headerlink" title="科技时代"></a>科技时代</h3><p>读大学那会儿，团购、O2O火起来；刚毕业那会团购死一大片、P2P网贷流行又迅速倒一片；今年流行是人工智能和VR，这应该是长久的，未来人类一直要做的努力，可以造福人类。互联网可能每隔5年会有一个颠覆性变化，从事it行业，平时工作学习编程以外，是需要多了解一下其他的东西，拓展自己的视野，前瞻性，提升自身价值的能力值和宽度。</p>
<h3 id="2017年愿景"><a href="#2017年愿景" class="headerlink" title="2017年愿景"></a>2017年愿景</h3><ul>
<li>多陪父母，多打电话</li>
<li>工作上期望有个好的技术氛围，多认识一些爱学习讨论的coder，更加努力，更快成长</li>
<li>开心的玩</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;年底了，毕业两年半，也就是工作2年半了，times flying！！！&lt;/p&gt;
&lt;p&gt;2016年，变化比较大的有三方面：工作地点由北京换到广州、脱离单身dog、gis行业转互联网（勉强算，都是做编程开发）。&lt;/p&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="Summary" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/Summary/"/>
    
    
      <category term="日记" scheme="http://giscafer.com/tags/%E6%97%A5%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>代码理解React组件生命周期过程</title>
    <link href="http://giscafer.com/2016/12/15/react-component-lifecycle/"/>
    <id>http://giscafer.com/2016/12/15/react-component-lifecycle/</id>
    <published>2016-12-14T16:30:30.000Z</published>
    <updated>2016-12-15T14:16:26.246Z</updated>
    
    <content type="html"><![CDATA[<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><p>React Component整个生命周期分为三大块：<strong>初始化——存在期（更新）——销毁清理</strong></p>
<h3 id="首次实例化-调用方法"><a href="#首次实例化-调用方法" class="headerlink" title="首次实例化 调用方法"></a>首次实例化 调用方法</h3><ul>
<li>getDefaultProps()</li>
<li>getInitialState()</li>
<li>componentWillMount()</li>
<li>render()</li>
<li>componentDidMount()()</li>
</ul>
<p><em>ES6写法中则为</em></p>
<ul>
<li>constructor()</li>
<li>componentWillMount()</li>
<li>render()</li>
<li>componentDidMount()</li>
</ul>
<h3 id="存在期-调用方法"><a href="#存在期-调用方法" class="headerlink" title="存在期 调用方法"></a>存在期 调用方法</h3><p><strong> <code>props</code> 或 <code>state</code>状态改变</strong></p>
<ul>
<li>componentWillReceiveProps()</li>
<li>shouldComponentUpdate()</li>
<li>componentWillUpdate()</li>
<li>render()</li>
<li>componentDidUpdate()</li>
</ul>
<h3 id="销毁清理-调用方法"><a href="#销毁清理-调用方法" class="headerlink" title="销毁清理 调用方法"></a>销毁清理 调用方法</h3><ul>
<li>componentWillUnmount()</li>
</ul>
<a id="more"></a>
<h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><p>创建一个<code>LifeCycleComponent.js</code>组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="meta">    'use strict'</span></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> Nav <span class="keyword">from</span> <span class="string">'../nav/Nav'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LifeCycleComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props)&#123;</div><div class="line">        <span class="keyword">super</span>(props);</div><div class="line">        fpLog(<span class="string">'初始化调用:constructor()'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//在完成首次渲染之前调用，此时仍可以修改组件的state</span></div><div class="line">    componentWillMount()&#123;</div><div class="line">        fpLog(<span class="string">'完成渲前调用:componentWillMount()'</span>)</div><div class="line">    &#125;</div><div class="line">    render()&#123;</div><div class="line">        fpLog(<span class="string">'渲染时调用:render()'</span>);</div><div class="line">        <span class="keyword">return</span>(</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">                <span class="tag">&lt;<span class="name">Nav</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.props.text&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://facebook.github.io/react/docs/react-component.html"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Component Specs and Lifecycle<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">    shouldComponentUpdate(nextProps, nextState)&#123;</div><div class="line">        <span class="comment">//该方法用来做一下性能优化，默认是返回true，返回false则阻止render()调用，跳过后续的生命周期方法</span></div><div class="line">        <span class="comment">//在首次渲染期间或者调用了forceUpdate方法后，该方法不会被调用</span></div><div class="line">        fpLog(<span class="string">'当渲染新的props或state调用:shouldComponentUpdate()'</span>);</div><div class="line">        fpLog2(<span class="string">'&lt;span style="color:blue"&gt;原始props.text='</span>+<span class="keyword">this</span>.props.text+<span class="string">'&lt;/span&gt;'</span>);</div><div class="line">        fpLog2(<span class="string">'&lt;span style="color:red"&gt;改变后的props.text='</span>+nextProps.text+<span class="string">'&lt;/span&gt;'</span>);</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.props.info!==nextProps.text)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    componentWillUpdate()&#123;</div><div class="line">         <span class="comment">//该方法中不允许更新props或state，也就是更新也是无效的</span></div><div class="line">        fpLog(<span class="string">'接收到新的props或者state后，进行渲染之前调用:componentWillUpdate()'</span>);</div><div class="line">    &#125;</div><div class="line">    componentDidUpdate()&#123;</div><div class="line">        fpLog(<span class="string">'完成渲染新的props或者state后调用，此时可以访问到新的DOM元素:componentDidUpdate()'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//真实DOM渲染后调用</span></div><div class="line">    componentDidMount()&#123;</div><div class="line">        fpLog(<span class="string">'真实DOM渲染后调用:componentDidMount()'</span>)</div><div class="line">    &#125;</div><div class="line">    componentWillReceiveProps(nextProps)&#123;</div><div class="line">        fpLog(<span class="string">'组件接收到新的props时调用:componentWillReceiveProps()---'</span>+nextProps.text)</div><div class="line">    &#125;</div><div class="line">    componentWillUnmount()&#123;</div><div class="line">        fpLog(<span class="string">'组件销毁前调用：componentWillUnmount()'</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">LifeCycleComponent.dispalyName=<span class="string">'LifeCycleComponentDemo'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> LifeCycleComponent;</div></pre></td></tr></table></figure>
<p><strong>父组件入口文件<code>Main.js</code></strong>，改组件主要用来动态改变<code>state</code>值后，观察<code>LifeCycleComponent</code>组件的生命周期方法的调用情况</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> LifeCycleApp <span class="keyword">from</span> <span class="string">'./LifeCycle'</span>;</div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LifeCycleMainComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>() &#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            <span class="attr">info</span>: <span class="string">'The React Component Lifecycle'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">LifeCycleApp</span> <span class="attr">text</span>=<span class="string">&#123;this.state.info&#125;</span> /&gt;</span></span></div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">    componentDidMount() &#123;</div><div class="line">        //定时更新state的值</div><div class="line">        setTimeout(() =&gt; &#123;</div><div class="line">            this.setState(&#123;</div><div class="line">                info: 'React组件生命周期'</div><div class="line">            &#125;)</div><div class="line">        &#125;, 2000)</div><div class="line">        setTimeout(() =&gt; &#123;</div><div class="line">            this.setState(&#123;</div><div class="line">                info: '再次改变state值'</div><div class="line">            &#125;)</div><div class="line">        &#125;, 5000)</div><div class="line">    &#125;</div><div class="line">    componentWillUnmount() &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">LifeCycleMainComponent.defaultProps = &#123;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">export default LifeCycleMainComponent;</div></pre></td></tr></table></figure>
<p>最后输出日志为：</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby"> 初始化调用<span class="symbol">:constructor</span>()</span></div><div class="line">-<span class="ruby"> 完成渲前调用<span class="symbol">:componentWillMount</span>()</span></div><div class="line">-<span class="ruby"> 渲染时调用<span class="symbol">:render</span>()</span></div><div class="line">-<span class="ruby"> 真实DOM渲染后调用<span class="symbol">:componentDidMount</span>()</span></div><div class="line">-<span class="ruby"> 组件接收到新的props时调用<span class="symbol">:componentWillReceiveProps</span>()---React组件生命周期</span></div><div class="line">-<span class="ruby"> 当渲染新的props或state调用<span class="symbol">:shouldComponentUpdate</span>()</span></div><div class="line">&gt;&gt;&gt; 原始props.text=The React Component Lifecycle</div><div class="line">&gt;&gt;&gt; 改变后的props.text=React组件生命周期</div><div class="line">-<span class="ruby"> 接收到新的props或者state后，进行渲染之前调用<span class="symbol">:componentWillUpdate</span>()</span></div><div class="line">-<span class="ruby"> 渲染时调用<span class="symbol">:render</span>()</span></div><div class="line">-<span class="ruby"> 完成渲染新的props或者state后调用，此时可以访问到新的DOM元素<span class="symbol">:componentDidUpdate</span>()</span></div><div class="line">-<span class="ruby"> 组件接收到新的props时调用<span class="symbol">:componentWillReceiveProps</span>()---再次改变state值</span></div><div class="line">-<span class="ruby"> 当渲染新的props或state调用<span class="symbol">:shouldComponentUpdate</span>()</span></div><div class="line">原始props.text=React组件生命周期</div><div class="line">改变后的props.text=再次改变state值</div><div class="line">-<span class="ruby"> 接收到新的props或者state后，进行渲染之前调用<span class="symbol">:componentWillUpdate</span>()</span></div><div class="line">-<span class="ruby"> 渲染时调用<span class="symbol">:render</span>()</span></div><div class="line">-<span class="ruby"> 完成渲染新的props或者state后调用，此时可以访问到新的DOM元素<span class="symbol">:componentDidUpdate</span>()</span></div></pre></td></tr></table></figure>
<p>结果截图：</p>
<p><img src="https://raw.githubusercontent.com/giscafer/react-demo-list/master/src/images/lifecycle.png" alt="React Component lifeCycle"></p>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><a href="https://github.com/giscafer/react-demo-list" target="_blank" rel="external">https://github.com/giscafer/react-demo-list</a></p>
<p>[参考链接]</p>
<ul>
<li><a href="https://facebook.github.io/react/docs/react-component.html" target="_blank" rel="external">React.Component</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;生命周期&quot;&gt;&lt;a href=&quot;#生命周期&quot; class=&quot;headerlink&quot; title=&quot;生命周期&quot;&gt;&lt;/a&gt;生命周期&lt;/h2&gt;&lt;p&gt;React Component整个生命周期分为三大块：&lt;strong&gt;初始化——存在期（更新）——销毁清理&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;首次实例化-调用方法&quot;&gt;&lt;a href=&quot;#首次实例化-调用方法&quot; class=&quot;headerlink&quot; title=&quot;首次实例化 调用方法&quot;&gt;&lt;/a&gt;首次实例化 调用方法&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;getDefaultProps()&lt;/li&gt;
&lt;li&gt;getInitialState()&lt;/li&gt;
&lt;li&gt;componentWillMount()&lt;/li&gt;
&lt;li&gt;render()&lt;/li&gt;
&lt;li&gt;componentDidMount()()&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;ES6写法中则为&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;constructor()&lt;/li&gt;
&lt;li&gt;componentWillMount()&lt;/li&gt;
&lt;li&gt;render()&lt;/li&gt;
&lt;li&gt;componentDidMount()&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;存在期-调用方法&quot;&gt;&lt;a href=&quot;#存在期-调用方法&quot; class=&quot;headerlink&quot; title=&quot;存在期 调用方法&quot;&gt;&lt;/a&gt;存在期 调用方法&lt;/h3&gt;&lt;p&gt;&lt;strong&gt; &lt;code&gt;props&lt;/code&gt; 或 &lt;code&gt;state&lt;/code&gt;状态改变&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;componentWillReceiveProps()&lt;/li&gt;
&lt;li&gt;shouldComponentUpdate()&lt;/li&gt;
&lt;li&gt;componentWillUpdate()&lt;/li&gt;
&lt;li&gt;render()&lt;/li&gt;
&lt;li&gt;componentDidUpdate()&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;销毁清理-调用方法&quot;&gt;&lt;a href=&quot;#销毁清理-调用方法&quot; class=&quot;headerlink&quot; title=&quot;销毁清理 调用方法&quot;&gt;&lt;/a&gt;销毁清理 调用方法&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;componentWillUnmount()&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="React" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/React/"/>
    
    
      <category term="React组件" scheme="http://giscafer.com/tags/React%E7%BB%84%E4%BB%B6/"/>
    
      <category term="React组件生命周期" scheme="http://giscafer.com/tags/React%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
    
  </entry>
  
  <entry>
    <title>hexo-theme-cafe</title>
    <link href="http://giscafer.com/2016/12/11/hexo-theme-cafe/"/>
    <id>http://giscafer.com/2016/12/11/hexo-theme-cafe/</id>
    <published>2016-12-11T03:40:35.000Z</published>
    <updated>2016-12-14T16:44:27.394Z</updated>
    
    <content type="html"><![CDATA[<p>尝试自己定制一个Hexo博客主题<code>Cafe</code>，Cafe 主题旨在追求简约、操作简单、阅读舒适度，详细介绍和源码见<a href="https://github.com/giscafer/hexo-theme-cafe" target="_blank" rel="external">https://github.com/giscafer/hexo-theme-cafe</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;尝试自己定制一个Hexo博客主题&lt;code&gt;Cafe&lt;/code&gt;，Cafe 主题旨在追求简约、操作简单、阅读舒适度，详细介绍和源码见&lt;a href=&quot;https://github.com/giscafer/hexo-theme-cafe&quot; target=&quot;_blank&quot; 
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="项目" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE/"/>
    
    
      <category term="项目" scheme="http://giscafer.com/tags/%E9%A1%B9%E7%9B%AE/"/>
    
      <category term="Hexo" scheme="http://giscafer.com/tags/Hexo/"/>
    
      <category term="cafe" scheme="http://giscafer.com/tags/cafe/"/>
    
  </entry>
  
  <entry>
    <title>WebGL Earth台风监测web应用webglearth-typhoon</title>
    <link href="http://giscafer.com/2016/10/16/webglearth-typhoon-project/"/>
    <id>http://giscafer.com/2016/10/16/webglearth-typhoon-project/</id>
    <published>2016-10-16T01:14:39.000Z</published>
    <updated>2016-12-14T16:49:11.334Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>花了一天时间，开发了一个基于<strong>WebGL Eerth</strong>的台风监测系统，写这个web应用的目的有两个：</p>
<p>1、我在github上创建了<a href="https://github.com/viseye" target="_blank" rel="external">@viseye</a>组织已经一段时间，但是迟迟没有项目，于是近期打算写一个</p>
<p>2、另一个原因是我再知乎开了<a href="https://zhuanlan.zhihu.com/viseye" target="_blank" rel="external">可视化编程</a>专栏，文章偶尔需要继续更新，就得找些东西来写</p>
<p>相关地址：</p>
<ul>
<li><p>github @viseye：<a href="https://github.com/viseye" target="_blank" rel="external">https://github.com/viseye</a></p>
</li>
<li><p>知乎可视化编程专栏：<a href="https://zhuanlan.zhihu.com/viseye" target="_blank" rel="external">https://zhuanlan.zhihu.com/viseye</a></p>
</li>
<li><p>VisEye Website: <a href="http://viseye.xyz" target="_blank" rel="external">http://viseye.xyz</a></p>
</li>
<li><p>个人微信公众号id：giscafer</p>
</li>
</ul>
<a id="more"></a>
<h2 id="台风监测web应用webglearth-typhoon"><a href="#台风监测web应用webglearth-typhoon" class="headerlink" title="台风监测web应用webglearth-typhoon"></a>台风监测web应用webglearth-typhoon</h2><h3 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h3><p><img src="https://raw.githubusercontent.com/viseye/webglearth-typhoon/master/public/images/screenshot.png" alt="image"></p>
<p><img src="https://raw.githubusercontent.com/viseye/webglearth-typhoon/master/public/images/show-compact2.gif" alt="image"></p>
<h3 id="Demo-Url"><a href="#Demo-Url" class="headerlink" title="Demo Url"></a>Demo Url</h3><p>在线demo:<a href="http://viseye.xyz/webglearth-typhoon/" target="_blank" rel="external">http://viseye.xyz/webglearth-typhoon/</a> </p>
<p><strong>请使用支持WebGL HTML5的浏览器打开，IE10+或新版Google Chrome等</strong></p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><ul>
<li><p><strong>1、服务端</strong></p>
<p>  服务端使用nodejs搭建服务器，提供前端数据请求的api接口，目前部署于BAE</p>
</li>
</ul>
<p><code>app.js</code>代码如下，主要是使用express搭建一个简单的server</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * app entry</div><div class="line"> */</div><div class="line"><span class="meta">'use strict'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> path=<span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">const</span> bodyParser=<span class="built_in">require</span>(<span class="string">'body-parser'</span>);</div><div class="line"><span class="keyword">const</span> Typhoon=<span class="built_in">require</span>(<span class="string">'node-typhoon'</span>);</div><div class="line"><span class="keyword">const</span> app=express();</div><div class="line"></div><div class="line">app.set(<span class="string">'port'</span>,(process.env.PORT || <span class="number">3000</span>));</div><div class="line"></div><div class="line">app.use(<span class="string">''</span>,express.static(path.join(__dirname,<span class="string">'public'</span>)));</div><div class="line">app.use(bodyParser.json());</div><div class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>:<span class="literal">true</span>&#125;));</div><div class="line"></div><div class="line"><span class="comment">// Additional middleware which will set headers that we need on each request.</span></div><div class="line">app.use(<span class="function">(<span class="params">req, res, next</span>)=&gt;</span> &#123;</div><div class="line">    res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>, <span class="string">'*'</span>);</div><div class="line">    <span class="comment">// Disable caching so we'll always get the latest comments.</span></div><div class="line">    res.setHeader(<span class="string">'Cache-Control'</span>, <span class="string">'no-cache'</span>);</div><div class="line">    next();</div><div class="line">&#125;);</div><div class="line"><span class="comment">//get real-time typhoon information </span></div><div class="line">app.get(<span class="string">'/api/typhoonActivity'</span>,(req,res)=&gt;&#123;</div><div class="line">	Typhoon.typhoonActivity().then(<span class="function"><span class="params">info</span>=&gt;</span>&#123;</div><div class="line">		res.send(info);</div><div class="line">	&#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</div><div class="line">		res.send(err);</div><div class="line">	&#125;);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//get historical typhoon information </span></div><div class="line">app.get(<span class="string">'/api/typhoonList'</span>,(req,res)=&gt;&#123;</div><div class="line">	<span class="keyword">let</span> year=<span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</div><div class="line">	Typhoon.typhoonList(year).then(<span class="function"><span class="params">info</span>=&gt;</span>&#123;</div><div class="line">		res.send(info);</div><div class="line">	&#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</div><div class="line">		res.send(err);</div><div class="line">	&#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">app.listen(app.get(<span class="string">'port'</span>),()=&gt;&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'Server started: http://localhost:'</span>+app.get(<span class="string">'port'</span>)+<span class="string">'/'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li><strong>2、中间件 node-typhoon</strong></li>
</ul>
<p>中间件说的是<code>nodejs</code>的<code>middleware</code>，<code>webglearth-typhoon</code>使用了个人自己封装的<code>node-typhoon</code>（已发布到npm），提供了获取实时台风的接口，以及历史台风信息的接口，目前版本是<code>v1.0.0</code>，后期会更新。</p>
<p><em>如下数据结果是今天（2016年10月15日11:53:33）获取的台风信息，两个台风从太平洋方向过来</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"enname"</span>: <span class="string">"SARIKA"</span>,</div><div class="line">    <span class="attr">"lat"</span>: <span class="string">"14.40"</span>,</div><div class="line">    <span class="attr">"lng"</span>: <span class="string">"124.30"</span>,</div><div class="line">    <span class="attr">"movedirection"</span>: <span class="string">"西北西"</span>,</div><div class="line">    <span class="attr">"movespeed"</span>: <span class="string">"22"</span>,</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"莎莉嘉"</span>,</div><div class="line">    <span class="attr">"power"</span>: <span class="string">"12"</span>,</div><div class="line">    <span class="attr">"pressure"</span>: <span class="string">"970"</span>,</div><div class="line">    <span class="attr">"radius10"</span>: <span class="string">"100"</span>,</div><div class="line">    <span class="attr">"radius7"</span>: <span class="string">"220"</span>,</div><div class="line">    <span class="attr">"speed"</span>: <span class="string">"35"</span>,</div><div class="line">    <span class="attr">"strong"</span>: <span class="string">"台风"</span>,</div><div class="line">    <span class="attr">"tfid"</span>: <span class="string">"201621"</span>,</div><div class="line">    <span class="attr">"time"</span>: <span class="string">"2016-10-15 11:00:00"</span>,</div><div class="line">    <span class="attr">"timeformate"</span>: <span class="string">"10月15日11时"</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"enname"</span>: <span class="string">"HAIMA"</span>,</div><div class="line">    <span class="attr">"lat"</span>: <span class="string">"8.20"</span>,</div><div class="line">    <span class="attr">"lng"</span>: <span class="string">"143.90"</span>,</div><div class="line">    <span class="attr">"movedirection"</span>: <span class="string">"北西"</span>,</div><div class="line">    <span class="attr">"movespeed"</span>: <span class="string">"22"</span>,</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"海马"</span>,</div><div class="line">    <span class="attr">"power"</span>: <span class="string">"8"</span>,</div><div class="line">    <span class="attr">"pressure"</span>: <span class="string">"998"</span>,</div><div class="line">    <span class="attr">"radius10"</span>: <span class="literal">null</span>,</div><div class="line">    <span class="attr">"radius7"</span>: <span class="string">"200"</span>,</div><div class="line">    <span class="attr">"speed"</span>: <span class="string">"18"</span>,</div><div class="line">    <span class="attr">"strong"</span>: <span class="string">"热带风暴"</span>,</div><div class="line">    <span class="attr">"tfid"</span>: <span class="string">"201622"</span>,</div><div class="line">    <span class="attr">"time"</span>: <span class="string">"2016-10-15 08:00:00"</span>,</div><div class="line">    <span class="attr">"timeformate"</span>: <span class="string">"10月15日8时"</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>更多见：<a href="https://www.npmjs.com/package/node-typhoon" target="_blank" rel="external">https://www.npmjs.com/package/node-typhoon</a></p>
<ul>
<li><strong>3、前端 webglearth2</strong></li>
</ul>
<p> 官方介绍：</p>
<p> webglearth2 - WebGL Earth 2 - the source code of the project,There is an extremely easy to use JavaScript API - fully mimicking LeafletJS.</p>
<p>webglearth2是一个开源虚拟地球web应用程序，可以运行在任何支持HTML5 WebGL标准的web浏览器上，以及移动设备,如iPhone,iPad或基于Android的手机也会支持</p>
<p>传送门：<a href="https://github.com/webglearth/webglearth2" target="_blank" rel="external">https://github.com/webglearth/webglearth2</a></p>
<p><strong>webglearth-typhoon实现整个思路:</strong></p>
<p>前端加载虚拟三维球+地图后，通过调用nodejs服务器中<code>node-typhoon</code>提供的Api获取台风信息，数据返回前端后，组装好，通过marker和气泡弹窗展示信息的方式加载到地图。This is all</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总结一下用到的技术</p>
<ul>
<li>JavaScript+HTML5+CSS 网页必须的，不多说</li>
<li>JavaScript新标准ES6，源码可能用了一些ES6的新特性书写</li>
<li>WebGL </li>
<li>LeafletJS 一个地图JavaScript库</li>
<li>Nodejs 服务端</li>
</ul>
<p>往上看一下，好像都是JavaScript~~~</p>
<h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>1、加上历史台风查询展示；</p>
<p>2、实时台风路径情况</p>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p>Github：<a href="https://github.com/viseye/webglearth-typhoon" target="_blank" rel="external">https://github.com/viseye/webglearth-typhoon</a></p>
<p><strong>爱学习、爱分享的同学，可关注个人微信公众号（id:giscafer）</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;花了一天时间，开发了一个基于&lt;strong&gt;WebGL Eerth&lt;/strong&gt;的台风监测系统，写这个web应用的目的有两个：&lt;/p&gt;
&lt;p&gt;1、我在github上创建了&lt;a href=&quot;https://github.com/viseye&quot;&gt;@viseye&lt;/a&gt;组织已经一段时间，但是迟迟没有项目，于是近期打算写一个&lt;/p&gt;
&lt;p&gt;2、另一个原因是我再知乎开了&lt;a href=&quot;https://zhuanlan.zhihu.com/viseye&quot;&gt;可视化编程&lt;/a&gt;专栏，文章偶尔需要继续更新，就得找些东西来写&lt;/p&gt;
&lt;p&gt;相关地址：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;github @viseye：&lt;a href=&quot;https://github.com/viseye&quot;&gt;https://github.com/viseye&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;知乎可视化编程专栏：&lt;a href=&quot;https://zhuanlan.zhihu.com/viseye&quot;&gt;https://zhuanlan.zhihu.com/viseye&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;VisEye Website: &lt;a href=&quot;http://viseye.xyz&quot;&gt;http://viseye.xyz&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;个人微信公众号id：giscafer&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="项目" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE/"/>
    
    
      <category term="WebGIS" scheme="http://giscafer.com/tags/WebGIS/"/>
    
      <category term="WebGL" scheme="http://giscafer.com/tags/WebGL/"/>
    
  </entry>
  
  <entry>
    <title>Git批处理|git-batch-file-builder</title>
    <link href="http://giscafer.com/2016/08/28/project-git-batch-file-builder/"/>
    <id>http://giscafer.com/2016/08/28/project-git-batch-file-builder/</id>
    <published>2016-08-28T14:44:18.000Z</published>
    <updated>2016-12-14T16:47:47.365Z</updated>
    
    <content type="html"><![CDATA[<p>编写此工具的原因是工作上遇到数十个工程，需要一个个git clone到本地，所以想使用工具替代重复的操作。</p>
<p>在<code>生成bat文件</code>时，需要允许浏览器弹窗下载文件，如下图：</p>
<p><img src="https://raw.githubusercontent.com/giscafer/git-batch-file-builder/master/allowpopwin.jpg" alt=""></p>
<p><strong>使用技术栈：</strong></p>
<ul>
<li>AngularJS 1.0.7+</li>
<li>Bootstrap 2.3.2+</li>
<li>Node.js</li>
</ul>
<p>github工程：<a href="https://github.com/giscafer/git-batch-file-builder" target="_blank" rel="external">https://github.com/giscafer/git-batch-file-builder</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;编写此工具的原因是工作上遇到数十个工程，需要一个个git clone到本地，所以想使用工具替代重复的操作。&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;生成bat文件&lt;/code&gt;时，需要允许浏览器弹窗下载文件，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githu
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Demo" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/Demo/"/>
    
    
      <category term="git批处理" scheme="http://giscafer.com/tags/git%E6%89%B9%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>前端面试笔记</title>
    <link href="http://giscafer.com/2016/08/10/the-interveiw-for-a-second-job/"/>
    <id>http://giscafer.com/2016/08/10/the-interveiw-for-a-second-job/</id>
    <published>2016-08-10T09:02:41.000Z</published>
    <updated>2016-12-14T16:48:30.874Z</updated>
    
    <content type="html"><![CDATA[<p>面试邀请很多，最后只面试了4个，一方面心累了，一方面想通过新的平台再加强一下自己，今后再次去尝试。<br><a id="more"></a></p>
<h3 id="2016-8-4-下午"><a href="#2016-8-4-下午" class="headerlink" title="2016-8-4 下午"></a>2016-8-4 下午</h3><p>下午，面试了本周第一家公司（这也是两年以来，第二次面对面的面试，第一次是北京的老东家，一干就干了2年整），这次面试的是一家做闪购的公司，公司办公地理位置好，环境不错，主要做的是App产品，去了才知道招聘的前端就主要是App的前端，这也是我最弱的地方了，一直做PC端的前端，在今年的6月份，离职前两个月，才接手一个ionic+angularjs相关的H5 App开发，功能模块的开发，当时时间紧张，所有的时间都花费在功能模块的开发，界面UI这些都是用现成的ionic的样式或者bootstrap样式；也就是没有设计美化UI，直接开发功能。<br>这是传统行业的特点，开发的时候都优先功能第一。</p>
<p>一直以来，我的App前端UI方向可以说是没有实践过的，给出一个设计图，通过HTML/CSS来仿真出来是有点困难，因为在老东家，这些都被美工、UI设计师包揽了。我能做的是在他们设计好的成品上进行简单的修改和调整，我是属<code>于偏JS方向的前端开发工程师</code></p>
<p><strong>面试过程：</strong><br>一、首先，填写个人资料，然后可能有笔试（前台给我拿了Linux运维的笔试题，猜想可能没准备前端笔试题目，所以我就没有参加笔试吧）。</p>
<p>二、然后，来了两人面试，一个负责技术提问，问了一些前端相关的问题，还有一些页面适配等问题；问的前端问题我是都会的，答得可能不好而已吧，我属于一个不善于表述的……但是问了手机端的页面适配，CSS相关的问题的话，我就捉急了，简单的可以，再深一点那就不行了，毕竟实践少，也没机会，业余学习也没注重。</p>
<p><strong>其他问题：</strong><br>1、JavaScript实现继承的方式有哪些；<br>2、call/apply的区别；<br>3、闭包了解；<br>4、对AMD、CMD规范的认识和区别；</p>
<p>三、最后，来了一个人，可能是技术负责相关人员，进来叫我简单的自我介绍一下，我就两句话就介绍完了，o(╯□╰)o，说了自己的意图而已。<br>这个面试官有3个问题：<br>1、一个网页打开比较慢的时候，你怎么去排除问题，会怀疑哪里出了问题？怎么解决这些问题？<br>2、如何清除浏览器的脏缓存？<br>3、你觉得你比别人优越在哪？</p>
<p>四、最终，hr进来大致了解一下情况，问一下以前的薪资，目前期望的薪资，个人情况和以前公司的大致情况等内容。</p>
<p><strong>总结：</strong><br>面试体验：怎个面试过程比较友善，面试官态度很好，最后都会问一下有没有想了解的问题<br>个人方面缺陷总结：<br>1、切片相关的技能，要加强，加强CSS技能<br>2、手机端相关的规范，布局、排版加强了解，最好是通过开发实践去学习<br>3、加强面试技巧，让自己会的都能表达出来，展示自己与别人不同的一面</p>
<h3 id="2016-8-5-下午"><a href="#2016-8-5-下午" class="headerlink" title="2016-8-5 下午"></a>2016-8-5 下午</h3><p>满满的面试安排，都推掉了，周二台风，一周就两个面试，早上都睡懒觉了，明天周末，又要休息两天；这不紧不慢的找工作，没谁了。。。<br>今天下午14:00面试，是一家做政务相关OA产品的公司，和老东家很详细啊，去了才清楚是做传统软件的。</p>
<p>面试流程：<br>一、填写表格；</p>
<p>二、hr面试，简单了解一下情况；</p>
<p>三、1道题上机，递归实现一个无限层级菜单（做不出来，囧~~，CSS实现样式效果是很大的硬伤，瞬间没心情了）</p>
<p>四、没做出来也继续和前端小组负责人面试，大致说了一些他们公司目前的工作情况，问了好几次我有没有要了解的问题，我都说没有。。。。</p>
<p>因为没有心情了，也没想问什么问题，最后问了几个简单的JavaScript基础问题；</p>
<p>1、js继承，call,apply使用</p>
<p>2、jquery的$.click和$.on(‘click’)方式绑定的区别，html的onclick属性和addEventListener绑定点击事件的区别；</p>
<p>3、jquery源码中的$.extend和fn.extend两者区别和$.extend是如何接收参数的。</p>
<p>4、如何对一篇文章全文检索某个字并高亮；</p>
<p>5、有没有使用过jquery的$.proxy方法，此方法的作用</p>
<p>五、技术负责人面完，我直接走了，我以为可以走了。都说好通知联系的；座上地铁后，HR打电话来说，经理想对我面试，可以商量一下薪资问题，能不能回来？我说不回去了……如果薪资不能满足简历要求，那就不联系了吧。。。其实按理还是回去比较好，出于礼貌，或者可以说是技术人员面试完，没说让我再坐一下，已经和我说如果可以，考虑什么时间入职，我说下下周一，然后就走了，挂我咯，主要还是不想回去，因为工作内容太像老东家，想换种工作模式。。。（完）</p>
<h3 id="2016-8-8-上午"><a href="#2016-8-8-上午" class="headerlink" title="2016-8-8 上午"></a>2016-8-8 上午</h3><p>今天是周一，上午去面试一家做汽车相关App的公司，办公环境很好，只是位置交通和宿舍之间交通不方便，步行很久。这家公司招聘的前端主要是做App页面和一些活动展示页，要求是CSS+JQuery+HTML5精通，能随手写出一个jquery插件，比如照片轮播插件等，这也完全是我的弱项。面试随意问了一些，看简历情况提问，问了如何设计一个照片轮播插件；apply/call区别，promise最后的处理，如何判断一个方法是否属于这个类等。然后就没然后了……叫我回来好好补一下CSS+HTML5这些，才能转前端，终归到底，还是要求偏向CSS的前端工程师……</p>
<h3 id="2016-8-8-下午"><a href="#2016-8-8-下午" class="headerlink" title="2016-8-8 下午"></a>2016-8-8 下午</h3><p>下午面试，是一家北京公司，广州分公司和亿迅合作做项目的，去了亿迅工作大厦面试，工作环境一般；流程是先笔试后面试；<br>笔试大概题目（以下就大概描述方向）：<br><strong>JavaScript基础问题：</strong><br>1、JavaScript操作CSS的float属性left（注意IE的区别）<br>2、正则判断一个字符串是否是Email<br>3、一道JavaScript题目，写出执行结果（考点主要是一些变量域+语句执行顺序等）<br>4、什么是闭包？写出一个闭包的例子。<br>5、add(2)(3)(4)的执行结果为9，写出函数体。<br><strong>JQuery问题：</strong><br>6、你是否了解jquery的$.ready方法？它是如何实现的？</p>
<p>7、你是否了解jquery的$.Deferred对象？它是用来解决什么问题？</p>
<p>8、一道插件题，说设计一个tab标签的话，你会提供是吗接口，给出什么功能，如果用户频繁的切换，会造成什么问题？怎么解决？<br><strong>Angular问题</strong><br>9、MVVM是什么？</p>
<p>10、谈谈Controller、Factory/Service、Filter的作用和区别？</p>
<p>11、不同的Controller直接是如何通信（传值）的？</p>
<p>12、请写出你Angular项目的目录结构？</p>
<p><strong>扩展题</strong></p>
<p>13、你还关注什么前沿的技术？谈谈他们的优势。</p>
<p>以上是笔试的大概内容，一共是三页题目，如果JavaScript基础牢，jquery熟悉，然后源码研究了解过的话，题目是不难的。angular考点也是基础问题。<br>面试官面试很快，估计是比较忙，赶时间。过来叫我自我介绍一下，然后问做过什么项目，简单说一下。问GET/POST在Restful中的区别，angular的MVVM的理解，<br>然后就没问多少，问一下期待薪资，然后就结束了。</p>
<h3 id="个人总结："><a href="#个人总结：" class="headerlink" title="个人总结："></a>个人总结：</h3><p>1、首先，离开帝都回广州发展，个人是裸辞，加上广州这边没认识的人，更没有程序猿的人脉；完全是靠自己回来闯，主要还是带着女票回来。来广州的时候，先主要解决租房子问题，租房子的过程，女朋友也一边去面试，两次面试两次都通过，实在厉害，最后确定了一家公司。最后我们用四天的时间找到了房子租，每个月1700的房租，找到房子后，我就开始网上投简历……</p>
<p>2、简历我选择了在拉勾网和前程无忧上放，拉钩的简历投过去反应太慢，有反应了等回复也需要好几天（所以建议简历提前投），那这样我就放更长的假期了；<br>前程无忧我大概投了5、6个公司，然后等消息，最终情况是，我选择投简历的公司都没有回应。但是，在前程无忧上刚放简历一天，就每天有十多个HR电话打过来， 前面的几天都在接电话，安排面试时间，主要的问题是，HR通过简单的公司介绍我都没能了解完全是个什么样子的公司，我不想不清楚是什么公司就去面试，避免浪费时间，迫不得已，我把前程无忧上的简历关闭掉了。</p>
<p>3、一共可能有20多个面试电话，GIS的也有好些个，GIS的面试邀请我是直接拒绝的，理由是不想再做GIS方向，因为传统的GIS行业+给政府做的项目、系统，都很随意，有点像堆功能似得，和个人追求相悖。刚开始面试也是有点懒散，起初安排早上的面试都没去，原因是睡懒觉+下大雨+有点远。于是我第一周面试只面试了一家……</p>
<p>4、第二周，我觉得不应该那么任性了，已经无业好几周了，觉得无聊，最终尝试了几个互联网前端岗位后，都要求CSS+HTML5比较高，高强度还原PS页面+兼容各个终端，自己胜任不了，以前关注重点都在JavaScript上了，CSS太弱，偏JavaScript，但是没接到偏JS前端的面试邀请呀。</p>
<p>5、目前的公司是用Angular+ES6的开发模式，用到Nodejs等，和自己之前学习的有共同部分，只是前端岗位没有要求去做CSS+HTML5那种高还原PS美工页面，打算先干着然后业余加技能，学精。</p>
<p><strong>6、学习目标：在现有工作胜任后，加强CSS+HTML5，以及精通JQuery插件书写，能手写CSS，高强度还原PS设计稿，兼容各个终端，加强HTML5 APP方向（这是理想的计划，目前自己还是偏向JS的前端开发,JS这边也要加强）</strong></p>
<h3 id="给跳槽的前端同学们建议："><a href="#给跳槽的前端同学们建议：" class="headerlink" title="给跳槽的前端同学们建议："></a>给跳槽的前端同学们建议：</h3><p>1、能不裸辞尽量别裸辞，提前投简历</p>
<p>2、简历不需要太多的装饰，只需要列出自己熟练掌握的技能，工作经验内容+项目列表，最重要的是，能提供项目或者作品展示最后（起码前端来说是最好的）</p>
<p>3、基础要牢固，框架的源码要了解</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;面试邀请很多，最后只面试了4个，一方面心累了，一方面想通过新的平台再加强一下自己，今后再次去尝试。&lt;br&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="工作" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/%E5%B7%A5%E4%BD%9C/"/>
    
    
      <category term="前端面试" scheme="http://giscafer.com/tags/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>自制Echarts地图数据 mapshaper-plus</title>
    <link href="http://giscafer.com/2016/06/06/echarts-data-map-project/"/>
    <id>http://giscafer.com/2016/06/06/echarts-data-map-project/</id>
    <published>2016-06-06T03:32:47.000Z</published>
    <updated>2017-01-10T15:43:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mapshaper-plus"><a href="#mapshaper-plus" class="headerlink" title="mapshaper-plus"></a>mapshaper-plus</h1><p>基于<a href="https://github.com/mbloch/mapshaper" target="_blank" rel="external">mapshaper</a>对geojson地图数据的坐标信息进行压缩编码，并提供可直接生成压缩编码后的echarts map数据格式</p>
<a id="more"></a>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p><a href="https://giscafer.github.io/mapshaper-plus/" target="_blank" rel="external">演示demo</a></p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><strong>介绍</strong> ——<a href="https://github.com/mbloch/mapshaper" target="_blank" rel="external">mapshaper</a>可以将多种数据格式（Shapefile, GeoJSON, TopoJSON<br>和 Zip files）导入后，对地图的编辑和导出（Shapefile, GeoJSON, TopoJSON, DSV, SVG），功能强大和简单易用。</p>
<p><code>mapshaper-plus</code>是在<code>mapshaper</code>基础上拓展对地图坐标信息的压缩编码，很大程度上减小了文件的代码行数和字节大小：譬如一个贵州省的数据，原始的<code>geojson</code>数据会在<code>30M</code>左右，但在对坐标信息压缩编码后，仅为<code>1.4M</code>。</p>
<p><strong>背景</strong> ——在做echarts图表统计时，需要自制地图数据，但官方没有提供一个平台可以直接将<code>shp文件</code>转化为压缩后的<code>json</code>或<code>js</code>格式的地图文件，而<code>mapshaper</code>导出的json数据没有压缩，数据量过大。</p>
<p>体验可以访问<a href="https://giscafer.github.io/mapshaper-plus/" target="_blank" rel="external">mapshaper-plus在线demo</a></p>
<h2 id="Screenshot"><a href="#Screenshot" class="headerlink" title="Screenshot"></a>Screenshot</h2><p><img src="https://raw.githubusercontent.com/giscafer/mapshaper-plus/master/images/echarts01.png" alt="导出压缩版的数据"></p>
<h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><p><a href="https://github.com/giscafer/mapshaper-plus" target="_blank" rel="external">https://github.com/giscafer/mapshaper-plus</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mapshaper-plus&quot;&gt;&lt;a href=&quot;#mapshaper-plus&quot; class=&quot;headerlink&quot; title=&quot;mapshaper-plus&quot;&gt;&lt;/a&gt;mapshaper-plus&lt;/h1&gt;&lt;p&gt;基于&lt;a href=&quot;https://github.com/mbloch/mapshaper&quot;&gt;mapshaper&lt;/a&gt;对geojson地图数据的坐标信息进行压缩编码，并提供可直接生成压缩编码后的echarts map数据格式&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Demo" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/Demo/"/>
    
    
      <category term="mapshaper" scheme="http://giscafer.com/tags/mapshaper/"/>
    
      <category term="echarts地图" scheme="http://giscafer.com/tags/echarts%E5%9C%B0%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>图片上传控件angluar-webuploader</title>
    <link href="http://giscafer.com/2016/04/23/project-angluar-webuploader/"/>
    <id>http://giscafer.com/2016/04/23/project-angluar-webuploader/</id>
    <published>2016-04-23T14:47:13.000Z</published>
    <updated>2016-12-14T16:47:38.179Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><p>最近公司做个项目需要使用AngularJS重新封装图片上传控件，支持IE低版本等，之间看过<code>JQuery-File-Upload</code>，尝试使用了一些，觉得文件太多，不好修改；最后使用<a href="http://fex.baidu.com/webuploader" target="_blank" rel="external">webuploader</a>时因为其简洁的界面和使用方便；</p>
<p><code>angluar-webuploader</code>是使用angular指令封装的webuploader demo，弹窗上传图片，缩略图展示列表，翻页效果；支持点击缩略图查看大图详情；</p>
<a id="more"></a>
<h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p><img src="https://raw.githubusercontent.com/giscafer/angular-webuploader/master/images/screenshot.png" alt="screenshot0"></p>
<p><img src="https://raw.githubusercontent.com/giscafer/angular-webuploader/master/images/screenshot2.png" alt="screenshot1"></p>
<p><img src="https://raw.githubusercontent.com/giscafer/angular-webuploader/master/images/screenshot1.png" alt="screenshot2"></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>本demo没有给出java后台代码，后台代码也简单，一个文件读写+图片压缩，返回结果参考以下<code>json</code>格式；<br>然后将图片上传接口请求地址在<code>app.js</code>配置后即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">	<span class="string">"status"</span>:<span class="literal">true</span>,<span class="comment">//上传成功状态</span></div><div class="line">	<span class="string">"newName"</span>:<span class="string">"/test/temp/upload/picture/20160422/c0c0b8f7bc574ec88f891ff834b79bab.jpg"</span>,<span class="comment">//原图片路径</span></div><div class="line">	<span class="string">"thumbName"</span>:<span class="string">"/test/temp/upload/picture/20160422/thumb/c0c0b8f7bc574ec88f891ff834b79bab.jpg"</span><span class="comment">//缩略图路径</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>源码地址，欢迎学习交流<br><a href="https://github.com/giscafer/angular-webuploader" target="_blank" rel="external">https://github.com/giscafer/angular-webuploader</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简述&quot;&gt;&lt;a href=&quot;#简述&quot; class=&quot;headerlink&quot; title=&quot;简述&quot;&gt;&lt;/a&gt;简述&lt;/h2&gt;&lt;p&gt;最近公司做个项目需要使用AngularJS重新封装图片上传控件，支持IE低版本等，之间看过&lt;code&gt;JQuery-File-Upload&lt;/code&gt;，尝试使用了一些，觉得文件太多，不好修改；最后使用&lt;a href=&quot;http://fex.baidu.com/webuploader&quot;&gt;webuploader&lt;/a&gt;时因为其简洁的界面和使用方便；&lt;/p&gt;
&lt;p&gt;&lt;code&gt;angluar-webuploader&lt;/code&gt;是使用angular指令封装的webuploader demo，弹窗上传图片，缩略图展示列表，翻页效果；支持点击缩略图查看大图详情；&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Demo" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/Demo/"/>
    
    
      <category term="webuploader" scheme="http://giscafer.com/tags/webuploader/"/>
    
      <category term="angluar" scheme="http://giscafer.com/tags/angluar/"/>
    
  </entry>
  
  <entry>
    <title>nodejs链接oracle</title>
    <link href="http://giscafer.com/2016/04/13/node-oracledb-demo/"/>
    <id>http://giscafer.com/2016/04/13/node-oracledb-demo/</id>
    <published>2016-04-13T03:30:17.000Z</published>
    <updated>2017-01-10T15:41:32.803Z</updated>
    
    <content type="html"><![CDATA[<h2 id="windows下node-oracledb环境"><a href="#windows下node-oracledb环境" class="headerlink" title="windows下node-oracledb环境"></a>windows下node-oracledb环境</h2><p>在windows环境下， oracle一直是个麻烦事情，参考官方<a href="https://github.com/oracle/node-oracledb/blob/master/INSTALL.md#instwin" target="_blank" rel="external">环境搭建说明</a><br><a id="more"></a><br>原本就在电脑上安装了<code>oracle11g</code>数据库,<code>VS2013</code>,<code>python2.7</code>，所以，我在环境变量下只需要再添加以下两个变量：<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">set OCI_LIB_DIR=D:<span class="symbol">\a</span>pp<span class="symbol">\g</span>iscafer<span class="symbol">\p</span>roduct<span class="symbol">\1</span>1.2.0<span class="symbol">\d</span>bhome_1<span class="symbol">\O</span>CI<span class="symbol">\l</span>ib<span class="symbol">\M</span>SVC</div><div class="line">set OCI_INC_DIR=D:<span class="symbol">\a</span>pp<span class="symbol">\g</span>iscafer<span class="symbol">\p</span>roduct<span class="symbol">\1</span>1.2.0<span class="symbol">\d</span>bhome_1<span class="symbol">\O</span>CI<span class="symbol">\i</span>nclude</div></pre></td></tr></table></figure></p>
<pre><code>npm install --save oracle
</code></pre><p><img src="/static/img/node-oracledb.png" alt="node-oracledb.png"></p>
<h2 id="oracle数据库连接"><a href="#oracle数据库连接" class="headerlink" title="oracle数据库连接"></a>oracle数据库连接</h2><p>1、安装<code>node-oracledb</code>完成后，新建一个数据库配置文件<code>dbconfig.js</code>：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">    </div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">user</span>          : process.env.NODE_ORACLEDB_USER || <span class="string">"scott"</span>,</div><div class="line"></div><div class="line">  <span class="comment">// Instead of hard coding the password, consider prompting for it,</span></div><div class="line">  <span class="comment">// passing it in an environment variable via process.env, or using</span></div><div class="line">  <span class="comment">// External Authentication.</span></div><div class="line">  password      : process.env.NODE_ORACLEDB_PASSWORD || <span class="string">"tiger"</span>,</div><div class="line"></div><div class="line">  <span class="comment">// For information on connection strings see:</span></div><div class="line">  <span class="comment">// https://github.com/oracle/node-oracledb/blob/master/doc/api.md#connectionstrings</span></div><div class="line">  connectString : process.env.NODE_ORACLEDB_CONNECTIONSTRING || <span class="string">"localhost/orcl"</span>,</div><div class="line"></div><div class="line">  <span class="comment">// Setting externalAuth is optional.  It defaults to false.  See:</span></div><div class="line">  <span class="comment">// https://github.com/oracle/node-oracledb/blob/master/doc/api.md#extauth</span></div><div class="line">  externalAuth  : process.env.NODE_ORACLEDB_EXTERNALAUTH ? <span class="literal">true</span> : <span class="literal">false</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>2、然后测试数据库连接，建个<code>connect.js</code>文件：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> oracledb = <span class="built_in">require</span>(<span class="string">'oracledb'</span>);</div><div class="line"><span class="keyword">var</span> dbConfig = <span class="built_in">require</span>(<span class="string">'./dbconfig.js'</span>);</div><div class="line"></div><div class="line">oracledb.getConnection(</div><div class="line">  &#123;</div><div class="line">    <span class="attr">user</span>          : dbConfig.user,</div><div class="line">    <span class="attr">password</span>      : dbConfig.password,</div><div class="line">    <span class="attr">connectString</span> : dbConfig.connectString</div><div class="line">  &#125;,</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">err, connection</span>)</span></div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">      <span class="built_in">console</span>.error(err.message);</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Connection was successful!'</span>);</div><div class="line"></div><div class="line">    connection.release(</div><div class="line">      <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span></div><div class="line">      &#123;</div><div class="line">        <span class="keyword">if</span> (err) &#123;</div><div class="line">          <span class="built_in">console</span>.error(err.message);</div><div class="line">          <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure></p>
<p>3、最后运行<code>connect.js</code>，成功会输出’Connection was successful!’信息</p>
<pre><code>node connect.js
</code></pre><h2 id="查询表"><a href="#查询表" class="headerlink" title="查询表"></a>查询表</h2><p>1、<code>npm install --save async</code></p>
<p>2、新建<code>`select.js</code>文件，代码如下（sql语句修改为自己需要查询的表语句即可）</p>
<p>3、<code>node select.js</code>执行即可看到结果，结果分为数据和对象两种处理方式，比较简单</p>
<p>测试结果图：</p>
<p><img src="/static/img/node-oracledb-select.png" alt=""></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">async</span> = <span class="built_in">require</span>(<span class="string">'async'</span>);</div><div class="line"><span class="keyword">var</span> oracledb = <span class="built_in">require</span>(<span class="string">'oracledb'</span>);</div><div class="line"><span class="keyword">var</span> dbConfig = <span class="built_in">require</span>(<span class="string">'./dbconfig.js'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Properties are applicable to all connections and SQL executions.</span></div><div class="line"><span class="comment">// They can also be set or overridden at the individual execute() call level</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// This script sets outFormat in the execute() call but it could be set here instead:</span></div><div class="line"><span class="comment">// oracledb.outFormat = oracledb.OBJECT;</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> doconnect = <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</div><div class="line">  oracledb.getConnection(</div><div class="line">    &#123;</div><div class="line">      <span class="attr">user</span>          : dbConfig.user,</div><div class="line">      <span class="attr">password</span>      : dbConfig.password,</div><div class="line">      <span class="attr">connectString</span> : dbConfig.connectString</div><div class="line">    &#125;,</div><div class="line">    cb);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> dorelease = <span class="function"><span class="keyword">function</span>(<span class="params">conn</span>) </span>&#123;</div><div class="line">  conn.release(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err)</div><div class="line">      <span class="built_in">console</span>.error(err.message);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// Default Array Output Format</span></div><div class="line"><span class="keyword">var</span> doquery_array = <span class="function"><span class="keyword">function</span> (<span class="params">conn, cb</span>) </span>&#123;</div><div class="line">  conn.execute(</div><div class="line">    <span class="string">"SELECT location_id, city FROM locations WHERE city LIKE 'S%' ORDER BY city"</span>,</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>)</span></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="keyword">return</span> cb(err, conn);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"----- Cities beginning with 'S' (default ARRAY output format) --------"</span>);</div><div class="line">        <span class="built_in">console</span>.log(result.rows);</div><div class="line">        <span class="keyword">return</span> cb(<span class="literal">null</span>, conn);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// Optional Object Output Format</span></div><div class="line"><span class="keyword">var</span> doquery_object = <span class="function"><span class="keyword">function</span> (<span class="params">conn, cb</span>) </span>&#123;</div><div class="line">  conn.execute(</div><div class="line">    <span class="string">"SELECT location_id, city FROM locations WHERE city LIKE 'S%' ORDER BY city"</span>,</div><div class="line">    &#123;&#125;, <span class="comment">// A bind variable parameter is needed to disambiguate the following options parameter</span></div><div class="line">        <span class="comment">// otherwise you will get Error: ORA-01036: illegal variable name/number</span></div><div class="line">    &#123; <span class="attr">outFormat</span>: oracledb.OBJECT &#125;, <span class="comment">// outFormat can be OBJECT or ARRAY.  The default is ARRAY</span></div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>)</span></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="keyword">return</span> cb(err, conn);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"----- Cities beginning with 'S' (OBJECT output format) --------"</span>);</div><div class="line">        <span class="built_in">console</span>.log(result.rows);</div><div class="line">        <span class="keyword">return</span> cb(<span class="literal">null</span>, conn);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">async</span>.waterfall(</div><div class="line">  [</div><div class="line">    doconnect,</div><div class="line">    doquery_array,</div><div class="line">    doquery_object</div><div class="line">  ],</div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err, conn</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123; <span class="built_in">console</span>.error(<span class="string">"In waterfall error cb: ==&gt;"</span>, err, <span class="string">"&lt;=="</span>); &#125;</div><div class="line">    <span class="keyword">if</span> (conn)</div><div class="line">      dorelease(conn);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<hr>
<p>更多见官方提供的例子：<br><a href="https://github.com/oracle/node-oracledb/tree/master/examples" target="_blank" rel="external">https://github.com/oracle/node-oracledb/tree/master/examples</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;windows下node-oracledb环境&quot;&gt;&lt;a href=&quot;#windows下node-oracledb环境&quot; class=&quot;headerlink&quot; title=&quot;windows下node-oracledb环境&quot;&gt;&lt;/a&gt;windows下node-oracledb环境&lt;/h2&gt;&lt;p&gt;在windows环境下， oracle一直是个麻烦事情，参考官方&lt;a href=&quot;https://github.com/oracle/node-oracledb/blob/master/INSTALL.md#instwin&quot;&gt;环境搭建说明&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="DataBase" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/DataBase/"/>
    
    
      <category term="node-oracledb" scheme="http://giscafer.com/tags/node-oracledb/"/>
    
      <category term="node.js链接oracle" scheme="http://giscafer.com/tags/node-js%E9%93%BE%E6%8E%A5oracle/"/>
    
  </entry>
  
  <entry>
    <title>Ponitor价格监测</title>
    <link href="http://giscafer.com/2016/03/31/project-ponitor/"/>
    <id>http://giscafer.com/2016/03/31/project-ponitor/</id>
    <published>2016-03-31T05:21:01.000Z</published>
    <updated>2016-12-14T16:47:55.773Z</updated>
    
    <content type="html"><![CDATA[<p>开发这个项目的初衷是学习<code>vue.js+webpack</code>构建应用，加上学习<code>ES6</code>之后没有正式在项目里边练习，然后偶然看到一个demo是做app爬虫的，加上本人又有计划入手个单反的想法，于是就有了<a href="https://github.com/giscafer/Ponitor" target="_blank" rel="external">Ponitor</a>。</p>
<p>项目支持对天猫、淘宝、和京东进行爬虫，关注一些商品，降价或涨价的时候都推送消息；（话说如果每天都监测商品价格，在双11和双12，会发现有些商家提前提升价格再故意降价的情况，哈哈哈……，只是猜测，不过这情况是会有的吧。），他们的恶劣行为会被<code>Ponitor</code>记录。</p>
<a id="more"></a>
<h2 id="关于商品信息获取"><a href="#关于商品信息获取" class="headerlink" title="关于商品信息获取"></a>关于商品信息获取</h2><p>1、爬虫Apple App是最方便的，一切信息都在html里边，只需要请求，解析出来即可。</p>
<p>2、爬虫京东和阿里的就不一样了，价格或者图片是被隐藏的，得通过其他方式；找到他们ajax请求的接口等。当接口如果发生变化，还需要调整修改。当然，只要页面能显示的数据，我们通过爬虫都能获取到；不过阿里是有很强的反爬虫机制的，当你请求数过多的时候，会强制跳转登录页面，要想记录爬信息，得通过这个关卡。。。。有时间研究一下吧。</p>
<p>3、补充：阿里反的是频繁爬虫，只要模拟好爬虫行为接近浏览器，或者是项目只对个人来使用（请求不会频繁），是没有任何问题的。</p>
<h2 id="项目截图"><a href="#项目截图" class="headerlink" title="项目截图"></a>项目截图</h2><p><img src="https://raw.githubusercontent.com/giscafer/Ponitor/master/wiki/index_preview.png" alt="index"></p>
<p><img src="https://raw.githubusercontent.com/giscafer/Ponitor/master/wiki/goodlist_preview.png" alt="index"></p>
<p>关注的商品价格发生变化（涨价or降价）的时候发生邮件通知，如测试截图：</p>
<p><img src="https://raw.githubusercontent.com/giscafer/Ponitor/master/wiki/email-sample.png" alt="index"></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>详情见README.md</p>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><a href="https://github.com/giscafer/Ponitor" target="_blank" rel="external">https://github.com/giscafer/Ponitor</a></p>
<p>欢迎交流学习！！！</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;开发这个项目的初衷是学习&lt;code&gt;vue.js+webpack&lt;/code&gt;构建应用，加上学习&lt;code&gt;ES6&lt;/code&gt;之后没有正式在项目里边练习，然后偶然看到一个demo是做app爬虫的，加上本人又有计划入手个单反的想法，于是就有了&lt;a href=&quot;https://github.com/giscafer/Ponitor&quot;&gt;Ponitor&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;项目支持对天猫、淘宝、和京东进行爬虫，关注一些商品，降价或涨价的时候都推送消息；（话说如果每天都监测商品价格，在双11和双12，会发现有些商家提前提升价格再故意降价的情况，哈哈哈……，只是猜测，不过这情况是会有的吧。），他们的恶劣行为会被&lt;code&gt;Ponitor&lt;/code&gt;记录。&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="项目" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE/"/>
    
    
      <category term="Project" scheme="http://giscafer.com/tags/Project/"/>
    
      <category term="vue" scheme="http://giscafer.com/tags/vue/"/>
    
      <category term="webpack" scheme="http://giscafer.com/tags/webpack/"/>
    
      <category term="node.js" scheme="http://giscafer.com/tags/node-js/"/>
    
  </entry>
  
  <entry>
    <title>知其然，知其所以然</title>
    <link href="http://giscafer.com/2016/03/18/diary2016-3-18/"/>
    <id>http://giscafer.com/2016/03/18/diary2016-3-18/</id>
    <published>2016-03-18T09:52:12.000Z</published>
    <updated>2016-12-14T16:50:09.265Z</updated>
    
    <content type="html"><![CDATA[<p>这是一篇简短而深刻的日记，记下此刻起（2016年3月18日17:58:35），日后在学习、工作用的技术知识点上，理解透彻其原理；做好一切<code>知其然，知其所以然</code>。</p>
<p>怀有一颗求知若渴的心，客观看清自身不足；做好现在的工作，展望未来！</p>
<p>写此谨记！</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这是一篇简短而深刻的日记，记下此刻起（2016年3月18日17:58:35），日后在学习、工作用的技术知识点上，理解透彻其原理；做好一切&lt;code&gt;知其然，知其所以然&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;怀有一颗求知若渴的心，客观看清自身不足；做好现在的工作，展望未来！&lt;/p&gt;

    
    </summary>
    
      <category term="随笔" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="胡思乱想" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/%E8%83%A1%E6%80%9D%E4%B9%B1%E6%83%B3/"/>
    
    
      <category term="diary" scheme="http://giscafer.com/tags/diary/"/>
    
  </entry>
  
  <entry>
    <title>npm设置淘宝镜像</title>
    <link href="http://giscafer.com/2016/03/08/npm-registry/"/>
    <id>http://giscafer.com/2016/03/08/npm-registry/</id>
    <published>2016-03-08T15:36:18.000Z</published>
    <updated>2016-12-14T16:47:10.989Z</updated>
    
    <content type="html"><![CDATA[<p>今晚使用npm下载<code>webpack</code>和其他插件时巨慢，这是以前从未遇到过的，所以就换了淘宝镜像，快了很多</p>
<p>更换镜像方式很多种，参考官方<a href="http://npm.taobao.org/" target="_blank" rel="external">文档说明</a></p>
<p>更方便的方式是，在c盘用户目录下，找到<code>.npmrc</code>文件，加入如下代码即可。</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">registry</span> = <span class="keyword">http</span>://<span class="keyword">registry</span>.npm.taobao.org</div></pre></td></tr></table></figure>
<p>或者手动设置</p>
<pre><code>npm config set registry http://registry.npm.taobao.org/
</code></pre><p>但是这样做有个问题，发布npm插件的时候需要<code>npm adduser</code>，如果<code>.npmrc</code>文件填了这个的话，是登录不上的，<br>所以记得发布插件的时候删除了，或者是通过上边<code>文档说明</code>提供的其他方式解决。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今晚使用npm下载&lt;code&gt;webpack&lt;/code&gt;和其他插件时巨慢，这是以前从未遇到过的，所以就换了淘宝镜像，快了很多&lt;/p&gt;
&lt;p&gt;更换镜像方式很多种，参考官方&lt;a href=&quot;http://npm.taobao.org/&quot; target=&quot;_blank&quot; rel
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="开发手册" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/"/>
    
    
      <category term="npm" scheme="http://giscafer.com/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>在Nodejs项目里写测试</title>
    <link href="http://giscafer.com/2016/02/12/nodejs-mocha-test/"/>
    <id>http://giscafer.com/2016/02/12/nodejs-mocha-test/</id>
    <published>2016-02-12T11:57:46.000Z</published>
    <updated>2017-01-10T15:41:32.895Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>不写测试的项目都是耍流氓</p>
</blockquote>
<p><code>BDD</code>和<code>TDD</code>的差别： <a href="http://joshldavis.com/2013/05/27/difference-between-tdd-and-bdd/" target="_blank" rel="external">The Difference Between TDD and BDD</a></p>
<a id="more"></a>
<h3 id="测试框架："><a href="#测试框架：" class="headerlink" title="测试框架："></a>测试框架：</h3><p><code>mocha</code></p>
<blockquote>
<p>Mocha是一个基于node.js和浏览器的集合各种特性的Javascript测试框架，并且可以让异步测试也变的简单和&gt; 有趣。Mocha的测试是连续的，在正确的测试条件中遇到未捕获的异常时，会给出灵活且准确的报告。</p>
</blockquote>
<h3 id="辅助工具"><a href="#辅助工具" class="headerlink" title="辅助工具"></a>辅助工具</h3><ul>
<li>should.js (BDD)</li>
<li>chai（支持assert,should,expect）</li>
<li>supertest (接口测试，代替浏览器地址请求，十分方便)</li>
</ul>
<p>一个典型的mocha例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">'chai'</span>).assert;</div><div class="line"><span class="keyword">var</span> expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</div><div class="line"><span class="keyword">var</span> should=<span class="built_in">require</span>(<span class="string">'chai'</span>).should();</div><div class="line"></div><div class="line"></div><div class="line">describe(<span class="string">'Test'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    before(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// runs before all tests in this block</span></div><div class="line">    &#125;);</div><div class="line">  after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="comment">// runs after all tests in this block</span></div><div class="line">  &#125;);</div><div class="line">  beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="comment">// runs before each test in this block</span></div><div class="line">  &#125;);</div><div class="line">  afterEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="comment">// runs after each test in this block</span></div><div class="line">  &#125;);</div><div class="line">    </div><div class="line">  describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  describe(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    it(<span class="string">'should return -1 when the value is not present'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].indexOf(<span class="number">5</span>).should.equal(<span class="number">-1</span>);</div><div class="line">      [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].indexOf(<span class="number">0</span>).should.equal(<span class="number">-1</span>);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li><code>beforeEach</code>会对当前<code>describe</code>下的所有子<code>case</code>生效。</li>
<li><code>before</code>和<code>after</code>的代码没有特殊顺序要求。</li>
<li>同一个<code>describe</code>下可以有多个<code>before</code>，执行顺序与代码顺序相同。</li>
<li>同一个<code>describe</code>下的执行顺序为<code>before</code>, <code>beforeEach</code>, <code>afterEach</code>, <code>after</code></li>
<li>当一个<code>it</code>有多个<code>before</code>的时候，执行顺序从最外围的<code>describe</code>的<code>before</code>开始，其余同理。</li>
</ul>
<p>1.<code>describe (moduleName, testDetails)</code>表示<code>测试套件</code>（test suite），表示一组相关的测试。它是一个函数，可以嵌套，第一个参数<code>moduleName</code>是测试套件的名称（可随意命名，一般描述测试内容），第二个参数<code>testDetails</code>是一个实际执行的函数。</p>
<p>2.<code>it (info, function)</code>块称为<code>测试用例</code>（test case），表示一个单独的测试，是测试的最小单位。它也是一个函数，第一个参数<code>info</code>是测试用例的名称，第二个参数<code>function</code>是一个实际执行的函数。</p>
<p>3.<code>done()</code> 按照瀑布流编程习惯，取名done是表示你回调的最深处，也就是结束写嵌套回调函数。但对于回调链来说done实际上意味着告诉mocha从此处开始测试，一层层回调回去。此外，一个测试用例下（也就是一个it）里面只能调用一次done。</p>
<p>4.使用命令<code>mocha --recursive</code>执行当前目录下所有的测试用例（包括子目录）</p>
<h3 id="supertest使用"><a href="#supertest使用" class="headerlink" title="supertest使用"></a>supertest使用</h3><p>  <code>supertest</code>可以用来测试nodejs项目中的Restful API，也就是，我们不需要在浏览器中输入请求地址测试。<br>  详细看<a href="https://github.com/visionmedia/supertest" target="_blank" rel="external">说明文档</a>，下面代码简单介绍：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = <span class="built_in">require</span>(<span class="string">'../app'</span>);</div><div class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">'supertest'</span>)(app);<span class="comment">//获取对象</span></div><div class="line">describe(<span class="string">'#showuser_list page'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    it(<span class="string">'should get admin/userlist'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</div><div class="line">        request.get(<span class="string">'/admin/userlist'</span>)<span class="comment">//请求地址</span></div><div class="line">            .set(<span class="string">'Cookie'</span>, support.adminUserCookie)</div><div class="line">            .expect(<span class="number">200</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;<span class="comment">//验证结果</span></div><div class="line">                res.text.should.contain(<span class="string">'用户管理'</span>);</div><div class="line">                done(err);</div><div class="line">            &#125;)</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="使用gulp自动化测试"><a href="#使用gulp自动化测试" class="headerlink" title="使用gulp自动化测试"></a>使用gulp自动化测试</h3><p>1、安装插件：</p>
<ul>
<li>gulp</li>
<li>gulp-watch</li>
<li>gulp-mocha</li>
</ul>
<p>2、添加<code>Gulpfile.js</code>文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> watch = <span class="built_in">require</span>(<span class="string">'gulp-watch'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> path = <span class="string">'src/server/test/**/*.js'</span>;</div><div class="line"></div><div class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  gulp.watch([<span class="string">'src/server/test/**/*.js'</span>, <span class="string">'lib/*.js'</span>], [<span class="string">'mocha'</span>]);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">var</span> mocha = <span class="built_in">require</span>(<span class="string">'gulp-mocha'</span>);</div><div class="line"> </div><div class="line">gulp.task(<span class="string">'mocha'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> gulp.src(path , &#123;<span class="attr">read</span>: <span class="literal">false</span>&#125;)</div><div class="line">        <span class="comment">// gulp-mocha needs filepaths so you can't have any plugins before it </span></div><div class="line">        .pipe(mocha(&#123;<span class="attr">reporter</span>: <span class="string">'spec'</span>&#125;));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'mocha'</span>, <span class="string">'watch'</span>]);</div></pre></td></tr></table></figure>
<p>3、运行监听测试文件改动，只要改动就会自动执行测试。</p>
<pre><code>gulp
</code></pre><h3 id="测试覆盖率"><a href="#测试覆盖率" class="headerlink" title="测试覆盖率"></a>测试覆盖率</h3><p>在github上的项目大都有如图所示标志：</p>
<p><img src="/static/img/coverage-build.png" alt="Build Status &amp; Coverage Status"></p>
<p><strong>下面介绍如何使用<code>Istanbul With Mocha</code>生成测试覆盖率</strong></p>
<p>需要安装的插件有：</p>
<ul>
<li><a href="https://github.com/nickmerwin/node-coveralls" target="_blank" rel="external">coveralls</a></li>
<li><a href="https://github.com/gotwarlost/istanbul" target="_blank" rel="external">istanbul</a></li>
<li>mocha</li>
</ul>
<p>1、在<code>package.json</code>文件中的script属性下加入npm自定义命令<code>mocha</code>和<code>cov</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">   <span class="string">"start"</span>: <span class="string">"node app.js"</span>,</div><div class="line">   <span class="string">"test"</span>: <span class="string">"./node_modules/.bin/gulp"</span>,</div><div class="line">   <span class="string">"mocha"</span>: <span class="string">"./node_modules/.bin/mocha -u bdd 'src/server/test/**/*.@(js|jsx)'"</span>,</div><div class="line">   <span class="string">"cov"</span>: <span class="string">"istanbul cover ./node_modules/mocha/bin/_mocha src/server/test/**/*.js --report lcovonly -- -R spec &amp;&amp; cat ./coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js &amp;&amp; rm -rf ./coverage"</span></div><div class="line"> &#125;,</div></pre></td></tr></table></figure>
<p><em>mocha命令意思是执行测试的语句，cov命令是生成测试覆盖命令，具体可以查看coveralls文档</em></p>
<p>2、使用github账号登录<code>travis-ci.org</code>站点，添加pro<br>在本地项目根目录中创建<code>.travis.yml</code>文件<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">language: node_js</div><div class="line">repo_token: Yt71K1wQ83RTyiSxvVwkgnrYn***FQn # 从coveralls.io获取</div><div class="line">services: mongodb</div><div class="line">node_js:</div><div class="line">  - stable</div><div class="line">  - 5.3</div><div class="line">sudo: false</div><div class="line">script: npm run mocha</div><div class="line">after_script: npm run cov</div></pre></td></tr></table></figure></p>
<p>3、同样使用github账号登录<code>coveralls.io</code>，添加该pro，然后进入<code>SET UP COVERALLS页</code>可以看到教程，选择第一个将代码复制到<code>.coveralls.yml</code>文件中（同样是在根目录创建）<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># travis-pro 填写travis-ci的pro名称</div><div class="line">service_name: Vue-order</div><div class="line">repo_token: Yt71K1wQ83RTyiSxvVwkgnrYng9rQTFQn</div></pre></td></tr></table></figure></p>
<p>4、最后push提交代码到github，在travis-ci查看项目是否自动部署成功，失败的话点击查看详细日记信息，根据失败信息解决问题即可。之后每次项目提交代码后，travis-ci上都会自动building项目。</p>
<p>5、成功后，将项目相应结果图片放到Readme.md下</p>
<pre><code>[![Build Status](https://travis-ci.org/giscafer/Vue-order.svg?branch=master)](https://travis-ci.org/giscafer/Vue-order)
[![Coverage Status](https://coveralls.io/repos/github/giscafer/Vue-order/badge.svg?branch=master)](https://coveralls.io/github/giscafer/Vue-order?branch=master)
</code></pre><p>如项目效果：<a href="https://github.com/giscafer/Vue-order" target="_blank" rel="external">https://github.com/giscafer/Vue-order</a></p>
<p>推荐几篇不错的文章：<br><a href="http://www.ruanyifeng.com/blog/2015/12/a-mocha-tutorial-of-examples.html" target="_blank" rel="external">测试框架 Mocha 实例教程</a><br><a href="https://cnodejs.org/topic/516526766d38277306c7d277#56beaebf26d02fc6626bb560" target="_blank" rel="external">初识 mocha in NodeJS</a><br><a href="https://cnodejs.org/topic/558df089ebf9c92d17e73358" target="_blank" rel="external">Nodejs开源项目里怎么样写测试、CI和代码测试覆盖率</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;不写测试的项目都是耍流氓&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;BDD&lt;/code&gt;和&lt;code&gt;TDD&lt;/code&gt;的差别： &lt;a href=&quot;http://joshldavis.com/2013/05/27/difference-between-tdd-and-bdd/&quot;&gt;The Difference Between TDD and BDD&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="开发手册" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/"/>
    
    
      <category term="mocha" scheme="http://giscafer.com/tags/mocha/"/>
    
      <category term="should" scheme="http://giscafer.com/tags/should/"/>
    
      <category term="BDD" scheme="http://giscafer.com/tags/BDD/"/>
    
  </entry>
  
  <entry>
    <title>工作一年半了</title>
    <link href="http://giscafer.com/2016/02/11/diary-2016-02-11/"/>
    <id>http://giscafer.com/2016/02/11/diary-2016-02-11/</id>
    <published>2016-02-11T14:51:39.000Z</published>
    <updated>2016-12-14T16:41:48.656Z</updated>
    
    <content type="html"><![CDATA[<p>2014年7月，毕业工作，成为了一名程序猿，我算是误打误撞的进了it行业；公司是做gis相关的，工作是做web开发，平时也就写写JavaScript和html\css……，慢慢的，觉得乏味，偶然关注了互联网前端开发，发现目前工作并不算是真正的前端开发，从此，开始学习互联网前端开发相关技术，并热衷无法自拔……</p>
<a id="more"></a>
<p>上学，由于学校本专业（gis)的研究方向是农业或土壤，个人觉得偏离了当时gis流行的云计算或者大数据可视化分析，课程也没多少有趣的；另外，教学专业编程能力相对其他院校来说应该是最弱的，要求也是最低的吧；在上学的日子里，我已经对GIS就业方向感到了迷茫，也不知道什么缘由，我觉得我只能去学习编程，毕业能找份工作。不管什么学校，什么专业，靠的是自己，教学多么好还是差，学霸和学渣都会有……</p>
<p>大三，第二学期我做了考研的打算，当时也报了培训班；最后由于自己心态问题，定不下心复习看书，当我把高数课本换成编程书籍的时候，我竟然能看下一整天……就这样，我的考研之路已经终止了。</p>
<p>大四，作为一个开发新入门的菜鸟，当时的我没什么要求，有份工作就行；有个环境能让我学习技术就好，我要逃出校园，因为校园太安逸，迷茫；学长学姐、老师也没和我说就业的严峻性，编程学习上，也没有人指导，一个班里，对编程感兴趣了可能就两人，这编程道路上也是孤独的。对去什么公司和做什么事情那会儿也没多少想法，有公司来校招就去应聘了，公司是北京的。（当时没想过什么北漂，也不清楚什么是北漂咯，天真其实也挺好）</p>
<p>工作后，习惯总结了自身编程缺失的地方，晚上下班和周末的时候有时间就会留在公司学习，那时也有哥们一起上晚自习，有个伴确实好，学习过程中可以交流；（当时身边的同事总以为我们在加班，内心偷着乐呵呵的）。薪资上，作为一名985毕业的学生，工资算开发人员里边垫底的，我也清楚这是看技术水平开的，没计较什么，就惭愧一下，感叹一下自己大学都在干嘛了？然后就开始打鸡血励志了，瞬间就会充满学习的动力；因为喜欢编程，所以相信自己的技术肯定会越学越好。</p>
<p>同事+舍友，公司里的同事总体都不错，项目经理和领导都很好，别人都说这是小公司比较好的情况，大公司就不一样了。舍友都是刚毕业一起实习最后一起工作的，一起住了单位宿舍，也一起合租过，相处的挺欢乐，有爱专研技术的，这个算是兴趣一样的地方，也有爱打篮球的伴。所以我觉得是幸运的，因为我是两者的受益者。一起玩的还有同部门的两个妹子（不过离职的比较早，但后边还偶尔联系着），总共7人，我们相处的不错，感觉就像大学同学般，这可能是刚毕业+第一份工作，大家遇到好玩的人吧，以后就难咯……</p>
<p>北京生活，我是比较宅，在北京没怎么玩，工作一年半也就去了后海，天安门，王府井，西单，鸟巢，香山，几个校园。大多好玩的都没去，因为身边的舍友太尼玛宅了，感觉我起初是没那么宅的，后边可能受影响，越来越宅。公司有个别的同事在北京工作半年多还没去过天安门的……（原因估计是没妹子约）。总的来说，在北京，如果考虑到买房买车，或者是经济自由，那确实是压力大。</p>
<p>2015年7月，我搬出来自己租房，顿时就感受到了经济上的一些压力。学习上，时间相对多点了，一方面公司的项目不多，另一方面，可能是租房环境比较安静，适合学习。后半年自己学习方向也越来越明确，也常逛开发社区，在github上更加活跃了；关注了很多大牛，作为学习的目标并超越。</p>
<p>2015年终，拿了积极进取奖，并拿到了人生第一份年终奖；工资和刚入职比翻了倍。</p>
<p>2015年学习使用的技术栈有：</p>
<p><code>nodejs</code>,<code>bootstrap</code>,<code>vue.js</code>,<code>jfinal</code>,<code>jade</code>,<code>mongodb</code>……</p>
<p>2016年，继续前端技术的学习；继续github；认识更多大牛和前辈；进军互联网！</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2014年7月，毕业工作，成为了一名程序猿，我算是误打误撞的进了it行业；公司是做gis相关的，工作是做web开发，平时也就写写JavaScript和html\css……，慢慢的，觉得乏味，偶然关注了互联网前端开发，发现目前工作并不算是真正的前端开发，从此，开始学习互联网前端开发相关技术，并热衷无法自拔……&lt;/p&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="胡思乱想" scheme="http://giscafer.com/categories/%E9%9A%8F%E7%AC%94/%E8%83%A1%E6%80%9D%E4%B9%B1%E6%83%B3/"/>
    
    
      <category term="diary" scheme="http://giscafer.com/tags/diary/"/>
    
      <category term="随笔" scheme="http://giscafer.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>阿里大鱼JavaScript SDK插件alidayujs</title>
    <link href="http://giscafer.com/2016/02/10/alidayujs-npm/"/>
    <id>http://giscafer.com/2016/02/10/alidayujs-npm/</id>
    <published>2016-02-10T13:11:06.000Z</published>
    <updated>2016-12-14T16:38:55.261Z</updated>
    
    <content type="html"><![CDATA[<p><code>alidayujs</code>是学习nodejs以来写的第一个<code>npm</code>插件，目前实现了短信发送接口的封装，其余语音等有时间再拓展吧。使用介绍见以下链接：</p>
<a id="more"></a>
<p>github源码:<a href="https://github.com/giscafer/alidayujs" target="_blank" rel="external">https://github.com/giscafer/alidayujs</a></p>
<p>npm地址：<a href="https://www.npmjs.com/package/alidayujs" target="_blank" rel="external">https://www.npmjs.com/package/alidayujs</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;alidayujs&lt;/code&gt;是学习nodejs以来写的第一个&lt;code&gt;npm&lt;/code&gt;插件，目前实现了短信发送接口的封装，其余语音等有时间再拓展吧。使用介绍见以下链接：&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="NodeJS" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/NodeJS/"/>
    
    
      <category term="NodeJS" scheme="http://giscafer.com/tags/NodeJS/"/>
    
      <category term="npm" scheme="http://giscafer.com/tags/npm/"/>
    
      <category term="alidayujs" scheme="http://giscafer.com/tags/alidayujs/"/>
    
      <category term="阿里大鱼sdk" scheme="http://giscafer.com/tags/%E9%98%BF%E9%87%8C%E5%A4%A7%E9%B1%BCsdk/"/>
    
  </entry>
  
  <entry>
    <title>mongoDB查询统计之Map-Reduce方法</title>
    <link href="http://giscafer.com/2016/02/05/mongodb-map-reduce/"/>
    <id>http://giscafer.com/2016/02/05/mongodb-map-reduce/</id>
    <published>2016-02-05T08:44:56.000Z</published>
    <updated>2016-12-14T16:45:54.674Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0、说明"><a href="#0、说明" class="headerlink" title="0、说明"></a>0、说明</h3><a id="more"></a>
<p>官方给的Map-Reduce的流程如下图：</p>
<p><img src="https://docs.mongodb.org/manual/_images/map-reduce.png" alt="此处输入图片的描述"></p>
<p>该函数接收三个参数：<code>map</code>,<code>reduce</code>,{<code>query</code>,<code>output</code>}；其中<code>map</code>,<code>reduce</code>是方法，最后一个参数是对象，<br>该对象可以使用<code>query</code>作为查询过滤条件，<code>output</code>的意思是将结果保存在临时的集合里边，最后用来查询。</p>
<p>首先，数据库我存的订餐数据如下所示：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">        <span class="attr">"_id"</span> : ObjectId(<span class="string">"56b45c45ad1434e863ea1406"</span>),</div><div class="line">        <span class="attr">"user_id"</span> : ObjectId(<span class="string">"568bbaa0e78f752802a65a7b"</span>),</div><div class="line">        <span class="attr">"dish_name"</span> : <span class="string">"韭菜鸡蛋"</span>,</div><div class="line">        <span class="attr">"deleted"</span> : <span class="literal">false</span>,</div><div class="line">        <span class="attr">"update_at"</span> : ISODate(<span class="string">"2016-02-05T08:24:37.761Z"</span>),</div><div class="line">        <span class="attr">"create_at"</span> : ISODate(<span class="string">"2016-02-05T08:24:37.761Z"</span>),</div><div class="line">        <span class="attr">"ispack"</span> : <span class="literal">false</span>,</div><div class="line">        <span class="attr">"dish_price"</span> : <span class="number">12</span>,</div><div class="line">        <span class="attr">"__v"</span> : <span class="number">0</span></div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">        <span class="attr">"_id"</span> : ObjectId(<span class="string">"56b45c5fad1434e863ea1407"</span>),</div><div class="line">        <span class="attr">"user_id"</span> : ObjectId(<span class="string">"568bbaa0e78f752802a65a7b"</span>),</div><div class="line">        <span class="attr">"dish_name"</span> : <span class="string">"红烧鸡块"</span>,</div><div class="line">        <span class="attr">"deleted"</span> : <span class="literal">false</span>,</div><div class="line">        <span class="attr">"update_at"</span> : ISODate(<span class="string">"2016-02-05T08:25:03.070Z"</span>),</div><div class="line">        <span class="attr">"create_at"</span> : ISODate(<span class="string">"2016-02-05T08:25:03.070Z"</span>),</div><div class="line">        <span class="attr">"ispack"</span> : <span class="literal">false</span>,</div><div class="line">        <span class="attr">"dish_price"</span> : <span class="number">15</span>,</div><div class="line">        <span class="attr">"__v"</span> : <span class="number">0</span></div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">        <span class="attr">"_id"</span> : ObjectId(<span class="string">"56b45c66ad1434e863ea1408"</span>),</div><div class="line">        <span class="attr">"user_id"</span> : ObjectId(<span class="string">"568bbaa0e78f752802a65a7b"</span>),</div><div class="line">        <span class="attr">"dish_name"</span> : <span class="string">"耗油生菜"</span>,</div><div class="line">        <span class="attr">"deleted"</span> : <span class="literal">false</span>,</div><div class="line">        <span class="attr">"update_at"</span> : ISODate(<span class="string">"2016-02-05T08:25:10.002Z"</span>),</div><div class="line">        <span class="attr">"create_at"</span> : ISODate(<span class="string">"2016-02-05T08:25:10.002Z"</span>),</div><div class="line">        <span class="attr">"ispack"</span> : <span class="literal">false</span>,</div><div class="line">        <span class="attr">"dish_price"</span> : <span class="number">13</span>,</div><div class="line">        <span class="attr">"__v"</span> : <span class="number">0</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下边会介绍对这些数据进行查询统计！</p>
<h3 id="1、map方法"><a href="#1、map方法" class="headerlink" title="1、map方法"></a>1、map方法</h3><p>先看代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> cate=<span class="keyword">this</span>.dish_name;<span class="comment">//以菜名进行统计</span></div><div class="line">    emit(cate,&#123;<span class="attr">price</span>:<span class="keyword">this</span>.dish_price&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>map方法里面会调用<code>emit(key, value)</code>，mongodb集合会按照指定的<code>key</code>进行映射分组, 类似关系型数据库的<code>group by</code>,<br>目的是<code>group by</code>上面map后的结果，最终为：按照cate分组, 分组结果是{name: this.name}的list。</p>
<h3 id="2、reduce方法"><a href="#2、reduce方法" class="headerlink" title="2、reduce方法"></a>2、reduce方法</h3><p>（遍历map的结果，统计订单中每种盖饭的总数和总价格）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reduce=<span class="function"><span class="keyword">function</span>(<span class="params">key,values</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> sum=<span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> totalCost=<span class="number">0</span>;</div><div class="line">    values.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">order</span>)</span>&#123;</div><div class="line">        sum+=<span class="number">1</span></div><div class="line">        totalCost+=order.price;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> &#123;<span class="attr">count</span>:sum,<span class="attr">cost</span>:totalCost&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3、执行mapReduce方法"><a href="#3、执行mapReduce方法" class="headerlink" title="3、执行mapReduce方法"></a>3、执行mapReduce方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">db.orders.mapReduce(map,reduce,&#123;<span class="attr">out</span>:<span class="string">"order_results"</span>&#125;);<span class="comment">//执行查询统计（这里没加query查询条件）</span></div><div class="line">db.order_results.find();<span class="comment">//查看结果，order_results就是out参数的写的临时集合</span></div></pre></td></tr></table></figure>
<p>查询结果如下，最终的集合里边，<code>_id</code>就是<code>cate</code>,<code>value</code>就是统计的值了。</p>
<blockquote>
<p>{ “_id” : “红烧鸡块”, “value” : { “count” : 2, “cost” : 30 } }<br>{ “_id” : “耗油生菜”, “value” : { “count” : 2, “cost” : 26 } }</p>
</blockquote>
<p>统计示例见：<a href="http://vueorder.duapp.com/charts" target="_blank" rel="external">订餐统计</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;0、说明&quot;&gt;&lt;a href=&quot;#0、说明&quot; class=&quot;headerlink&quot; title=&quot;0、说明&quot;&gt;&lt;/a&gt;0、说明&lt;/h3&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="DataBase" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/DataBase/"/>
    
    
      <category term="mongoDB" scheme="http://giscafer.com/tags/mongoDB/"/>
    
      <category term="mapReduce" scheme="http://giscafer.com/tags/mapReduce/"/>
    
      <category term="mongoDB统计" scheme="http://giscafer.com/tags/mongoDB%E7%BB%9F%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>NodeJS开发常见错误A&amp;Q</title>
    <link href="http://giscafer.com/2016/02/05/nodejs-overflow-question/"/>
    <id>http://giscafer.com/2016/02/05/nodejs-overflow-question/</id>
    <published>2016-02-05T06:18:08.000Z</published>
    <updated>2016-12-14T16:46:52.515Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0、NodeJS调试介绍"><a href="#0、NodeJS调试介绍" class="headerlink" title="0、NodeJS调试介绍"></a>0、NodeJS调试介绍</h2><p>级别从高到低，推荐到不推荐：</p>
<ol>
<li>ttd/bdd测试驱动</li>
<li>node-inspector，vsc编辑器，webstrom；</li>
<li>node-debug</li>
<li>console.log</li>
</ol>
<a id="more"></a>
<h2 id="1、CookieParser错误"><a href="#1、CookieParser错误" class="headerlink" title="1、CookieParser错误"></a>1、CookieParser错误</h2><p><code>throw new Error(&#39;cookieParser(&quot;secret&quot;) required for signed cookies&#39;);</code><br>提示：<strong>Error: cookieParser(“secret”) required for signed cookies</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">app.use(cookieParser(config.auth_cookie_name));//这里cookieParser(&quot;secret&quot;)需要指定内容&quot;secret&quot;</div><div class="line">//因为版本问题，这里坑里好一会</div><div class="line">app.use(session(&#123;</div><div class="line">  secret:config.session_secret,</div><div class="line">  key: config.auth_cookie_name, //这里auth_cookie_name就是指定内容&quot;secret&quot;</div><div class="line">  cookie: &#123;maxAge: 1000 * 60 * 60 * 24 * 30&#125;,//30 days</div><div class="line">  resave: false,</div><div class="line">  saveUninitialized: true,</div><div class="line">  store: new MongoStore(&#123;</div><div class="line">    url: config.dev_dbUrl</div><div class="line">  &#125;)</div><div class="line">&#125;));</div></pre></td></tr></table></figure>
<p>出现以上问题可能是在代码中使用类似<code>var auth_token = req.signedCookies[config.auth_cookie_name];</code>代码，如果没用，以上直接使用<code>pp.use(cookieParser());</code>即可。</p>
<p>参考解决：<br><a href="https://segmentfault.com/a/1190000004139342" target="_blank" rel="external">https://segmentfault.com/a/1190000004139342</a><br><a href="http://stackoverflow.com/questions/20112876/cookieparser-and-cookiesession-middleware-in-expressjs" target="_blank" rel="external">http://stackoverflow.com/questions/20112876/cookieparser-and-cookiesession-middleware-in-expressjs</a></p>
<h2 id="2、Cast-to-ObjectId-failed-for-value"><a href="#2、Cast-to-ObjectId-failed-for-value" class="headerlink" title="2、Cast to ObjectId failed for value"></a>2、Cast to ObjectId failed for value</h2><p>错误大致：</p>
<pre><code>500 CastError: Cast to ObjectId failed for value &quot;Mp0uah2G6TJVwPhOQ2sSZ10yklPkmbRV&quot; at path &quot;_id&quot;
 at MongooseError.CastError (/home/bae/app/.bae/node_modules/mongoose/lib/error/cast.js:19:11)
 at ObjectId.cast (/home/bae/app/.bae/node_modules/mongoose/lib/schema/objectid.js:134:13)
 at ObjectId.castForQuery (/home/bae/app/.bae/node_modules/mongoose/lib/schema/objectid.js:173:17)
 at module.exports (/home/bae/app/.bae/node_modules/mongoose/lib/cast.js:205:32)
 at Query.cast (/home/bae/app/.bae/node_modules/mongoose/lib/query.js:2533:10)
 at Query.findOne (/home/bae/app/.bae/node_modules/mongoose/lib/query.js:1239:10)
 at Function.findOne (/home/bae/app/.bae/node_modules/mongoose/lib/model.js:1254:13)
 at Object.exports.getUserById (/home/bae/app/src/server/proxy/user.js:39:7)
 at exports.authUser (/home/bae/app/src/server/common/auth.js:114:19)
 at Layer.handle [as handle_request] (/home/bae/app/.bae/node_modules/express/lib/router/layer.js:95:5)
 at trim_prefix (/home/bae/app/.bae/node_modules/express/lib/router/index.js:312:13)
 at /home/bae/app/.bae/node_modules/express/lib/router/index.js:280:7
 at Function.process_params (/home/bae/app/.bae/node_modules/express/lib/router/index.js:330:12)
 at next (/home/bae/app/.bae/node_modules/express/lib/router/index.js:271:10)
 at /home/bae/app/.bae/node_modules/express-session/index.js:437:7
 at Command.callback (/home/bae/app/.bae/node_modules/connect-redis/lib/connect-redis.js:158:14)
</code></pre><p>这个问题可能和<code>1问题</code>有相关，如果不是，参考以下解决方案：</p>
<p><a href="http://stackoverflow.com/questions/15771470/mongoose-cast-to-objectid-failed-for-value" target="_blank" rel="external">http://stackoverflow.com/questions/15771470/mongoose-cast-to-objectid-failed-for-value</a></p>
<p><a href="http://stackoverflow.com/questions/25380388/error-casterror-cast-to-objectid-failed-for-value-at-path-id" target="_blank" rel="external">http://stackoverflow.com/questions/25380388/error-casterror-cast-to-objectid-failed-for-value-at-path-id</a></p>
<h2 id="3、model对象赋值不成功，需要创建字段。"><a href="#3、model对象赋值不成功，需要创建字段。" class="headerlink" title="3、model对象赋值不成功，需要创建字段。"></a>3、model对象赋值不成功，需要创建字段。</h2><p>目前通过schema创建字段解决。原因未知。</p>
<h2 id="4、SyntaxError-Use-of-const-in-strict-mode"><a href="#4、SyntaxError-Use-of-const-in-strict-mode" class="headerlink" title="4、SyntaxError: Use of const in strict mode."></a>4、SyntaxError: Use of const in strict mode.</h2><pre><code>/home/bae/app/.bae/node_modules/connect-mongo/src/index.js:3
const Promise = require(&apos;bluebird&apos;);
^^^^^
SyntaxError: Use of const in strict mode.
</code></pre><h2 id="5、Error-Can’t-set-headers-after-they-are-sent"><a href="#5、Error-Can’t-set-headers-after-they-are-sent" class="headerlink" title="5、Error: Can’t set headers after they are sent."></a>5、Error: Can’t set headers after they are sent.</h2><p><code>Can’t set headers after they are sent.</code> =&gt; <code>不能发送headers因为已经发送过一次了</code> =&gt; 在处理HTTP请求时，服务器会先输出响应头，<br>然后再输出主体内容，而一旦输出过一次响应头（比如执行过 <code>res.writeHead()</code> 或 <code>res.write()</code> 或 <code>res.end()</code>），<br>你再尝试通过 <code>res.setHeader()</code> 或 <code>res.writeHead()</code> 来设置响应头时（有些方法比如 <code>res.redirect()</code> 会调用 <code>res.writeHead()</code>），就会报这个错误。</p>
<p>（说明：express中的 res.header() 相当于 res.writeHead() ，res.send() 相当于 res.write() ）</p>
<p>原因就是你程序有问题，重复作出响应，具体原因很多，需要自己根据以上的原则来排除。</p>
<p>解决：<code>在一个回调函数前边应该加一个return</code></p>
<p>参考：</p>
<p><a href="https://cnodejs.org/topic/53774ffecbcc396349ca1155" target="_blank" rel="external">https://cnodejs.org/topic/53774ffecbcc396349ca1155</a></p>
<p><a href="http://stackoverflow.com/questions/7042340/node-js-error-cant-set-headers-after-they-are-sent" target="_blank" rel="external">http://stackoverflow.com/questions/7042340/node-js-error-cant-set-headers-after-they-are-sent</a></p>
<h2 id="6、Redis-ERR-wrong-number-of-arguments-for-‘set’-command"><a href="#6、Redis-ERR-wrong-number-of-arguments-for-‘set’-command" class="headerlink" title="6、Redis:ERR wrong number of arguments for ‘set’ command"></a>6、Redis:ERR wrong number of arguments for ‘set’ command</h2><p>将<a href="https://github.com/giscafer/Vue-order" target="_blank" rel="external">Vue-order</a>部署BAE的时候遇到此Redis报错问题，系统访问就会报此错误 最后查出是因为connect-redis插件版本引起的；（该原因也可能是代码引起）</p>
<h2 id="7、express-session-deprecated-cookie-should-be-available-in-req-headers-cookie"><a href="#7、express-session-deprecated-cookie-should-be-available-in-req-headers-cookie" class="headerlink" title="7、express-session deprecated cookie should be available in req.headers.cookie"></a>7、express-session deprecated cookie should be available in req.headers.cookie</h2><p><a href="https://segmentfault.com/a/1190000004139342" target="_blank" rel="external">https://segmentfault.com/a/1190000004139342</a><br><a href="https://github.com/expressjs/session/issues/62" target="_blank" rel="external">https://github.com/expressjs/session/issues/62</a></p>
<h2 id="8、Error-Argument-passed-in-must-be-a-single-String-of-12-bytes-or-a-string-of-24-hex-characters"><a href="#8、Error-Argument-passed-in-must-be-a-single-String-of-12-bytes-or-a-string-of-24-hex-characters" class="headerlink" title="8、Error: Argument passed in must be a single String of 12 bytes or a string of 24 hex characters"></a>8、Error: Argument passed in must be a single String of 12 bytes or a string of 24 hex characters</h2><p>必须是24位16进制的字符，或者一个12字节的字符串</p>
<p><a href="http://stackoverflow.com/questions/26453507/argument-passed-in-must-be-a-single-string-of-12-bytes" target="_blank" rel="external">http://stackoverflow.com/questions/26453507/argument-passed-in-must-be-a-single-string-of-12-bytes</a></p>
<p><a href="https://docs.mongodb.org/manual/reference/object-id/" target="_blank" rel="external">https://docs.mongodb.org/manual/reference/object-id/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0、NodeJS调试介绍&quot;&gt;&lt;a href=&quot;#0、NodeJS调试介绍&quot; class=&quot;headerlink&quot; title=&quot;0、NodeJS调试介绍&quot;&gt;&lt;/a&gt;0、NodeJS调试介绍&lt;/h2&gt;&lt;p&gt;级别从高到低，推荐到不推荐：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ttd/bdd测试驱动&lt;/li&gt;
&lt;li&gt;node-inspector，vsc编辑器，webstrom；&lt;/li&gt;
&lt;li&gt;node-debug&lt;/li&gt;
&lt;li&gt;console.log&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="技术" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="开发手册" scheme="http://giscafer.com/categories/%E6%8A%80%E6%9C%AF/%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/"/>
    
    
      <category term="NodeJS" scheme="http://giscafer.com/tags/NodeJS/"/>
    
      <category term="Q&amp;A" scheme="http://giscafer.com/tags/Q-A/"/>
    
  </entry>
  
</feed>
