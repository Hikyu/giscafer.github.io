A.addCssText(".opui-addtohome-box{border-top: 1px solid #f3f3f3;border-bottom: 1px solid #f3f3f3;padding:3px 0 4px;margin:4px 0;display:none}.opui-addtohome-box i{float:right;cursor:pointer}.opui-addtohome-icon {display: inline-block;width: 20px;height: 20px;vertical-align: text-bottom;font-style: normal;overflow: hidden;background:url(//www.baidu.com/aladdin/other/base/ala_icons.png) no-repeat 0 0;}.opui-addtohome-icon-add {background-position: -3px 1px}.opui-addtohome-icon-added {background-position: -51px 1px}.opui-addtohome-icon-close {background-position: -90px 1px}");define(function(e){var l="//www.baidu.com",g,c,f,b,a,j,d=["TITLE","LINK","IMG","BTN","INPUT","OTHERS"],k=["btn"];var m={init:function(n){g=n||{};j=this;var o=$(n.container);a=o.find("div.opui-addtohome-box");a.find("i").click(function(){j.closeFunction();a.remove()});a.find("a").click(function(){if($(this).attr("data-click")){j.addToHome()}});o.on("mousedown",function(v){var v=window.event||v,q=v.srcElement||v.target,x=$(q);if(a.is(":visible")){return}if(q.tagName.toLowerCase()=="a"){a.show();return}try{var u=q,r=d,p=r.length,s=k,w=s.length;i=0;while(x!==o&&!(x.hasClass("result")||x.hasClass("result-op")||x.hasClass("xpath-log"))){for(i=0;i<p;i++){if(x.hasClass("OP_LOG_"+r[i])){a.show();return}}for(i=0;i<w;i++){if(x.hasClass("c-"+s[i])){a.show();return}}x=x.parent()}}catch(v){}})},addToHome:function(){if(!bds.comm.user){bds.se.login.setSubpro&&bds.se.login.setSubpro(g.src_id);bds.se.login.open(function(o,n){if(o==1){ns_c({xman_display:0,frm:"login"});h()}});return}h()},closeFunction:function(){$.ajax({url:l+"/home/xman/submit/searchsubclose?"+$.param({from:"psaladdin",resname:g.homeAppResname,uri:g.homeAppUri,ie:"utf-8",oe:"utf-8",timeout:3000})})},dispose:function(){clearTimeout(b);this.subscribeAjaxStop=true}};var h=function(){if(f){return}f=true;$.ajax({url:l+"/home/xman/submit/subscribe?"+$.param({from:"psaladdin",resname:g.homeAppResname,uri:g.homeAppUri,ie:"utf-8",oe:"utf-8"}),type:"get",success:function(n){n=$.parseJSON(n);if(c){return}if(n&&n.status=="0"){b=setTimeout(function(){a.html('<i class="opui-addtohome-icon opui-addtohome-icon-close OP_LOG_BTN" data-click="{fm:\'beha\'}"></i><span class="opui-addtohome-icon opui-addtohome-icon-added"></span><span class="c-gray">'+g.homeAppSubText+"</span>"+'<a href="'+(g.homeAppSuperUrl||"http://www.baidu.com/?from=alaadd")+'" target="_blank" >百度首页</a>');a.find("i").click(function(){j.closeFunction();a.remove()});f=false},200)}else{a.find("a").html("添加失败，重新添加");f=false;firstClick=false}},timeout:3000})};return m});